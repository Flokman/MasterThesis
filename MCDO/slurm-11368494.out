
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompic-2019b => FFTW/3.3.8-gompi-2019b
  2) OpenMPI/3.1.4-gcccuda-2019b => OpenMPI/3.1.4-GCC-8.3.0
  3) ScaLAPACK/2.0.2-gompic-2019b => ScaLAPACK/2.0.2-gompi-2019b
  4) SciPy-bundle/2019.10-fosscuda-2019b-Python-3.7.4 => SciPy-bundle/2019.10-foss-2019b-Python-3.7.4

2020-05-11 12:01:02.017932: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-11 12:01:17.489786: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-05-11 12:01:17.498001: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-11 12:01:17.498568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GRID V100D-32Q computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 31.88GiB deviceMemoryBandwidth: 836.37GiB/s
2020-05-11 12:01:17.498675: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-11 12:01:17.505081: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-11 12:01:17.509406: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-11 12:01:17.511414: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-11 12:01:17.515737: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-11 12:01:17.518299: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-11 12:01:17.524878: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-11 12:01:17.525170: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-11 12:01:17.525847: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-11 12:01:17.526271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-05-11 12:01:17.529664: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-11 12:01:17.530152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GRID V100D-32Q computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 31.88GiB deviceMemoryBandwidth: 836.37GiB/s
2020-05-11 12:01:17.530243: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-11 12:01:17.530323: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-11 12:01:17.530386: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-11 12:01:17.530448: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-11 12:01:17.530509: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-11 12:01:17.530571: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-11 12:01:17.530632: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-11 12:01:17.530803: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-11 12:01:17.531319: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-11 12:01:17.531724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-05-11 12:01:17.531827: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-11 12:01:18.266473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1096] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-05-11 12:01:18.266655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102]      0 
2020-05-11 12:01:18.266713: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] 0:   N 
2020-05-11 12:01:18.267183: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-11 12:01:18.268029: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-11 12:01:18.268616: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-11 12:01:18.269109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1241] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 28652 MB memory) -> physical GPU (device: 0, name: GRID V100D-32Q, pci bus id: 0000:02:00.0, compute capability: 7.0)
2020-05-11 12:01:18.269560: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 12. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
2020-05-11 12:01:22.846140: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-11 12:01:23.123256: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-11 12:01:25.140541: I tensorflow/core/profiler/lib/profiler_session.cc:225] Profiler session started.
2020-05-11 12:01:25.140747: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1259] Profiler found 1 GPUs
2020-05-11 12:01:25.144188: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcupti.so.10.1
2020-05-11 12:01:25.244998: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1307] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_VIRTUALIZED_DEVICE_NOT_SUPPORTED
2020-05-11 12:01:25.245749: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1346] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI_ERROR_VIRTUALIZED_DEVICE_NOT_SUPPORTED
2020-05-11 12:01:25.264393: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1329] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI_ERROR_INVALID_PARAMETER
2020-05-11 12:01:25.264521: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:88]  GpuTracer has collected 0 callback api events and 0 activity events.
dataset_name = CIFAR10, batch_size = 32, num_classes = 10, epochs = 500,
        MCDO_amount_of_predictions = 50, MCDO_batch_size = 250, test_img_idx = 3965,
        train_test_split = 0.8, to_shuffle = False, augmentation = False,
        label_normalizer = False, save_augmentation_to_hdf5 = False, learn rate = 1e-05,
        add_dropout_inside = True, train_all_layers = True, weights_to_use = imagenet,
        mcdo = True, es_patience = 5, train_val_split = 0.9, Dropoutrates: [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.5, 0.5], MIN_DELTA = 0.005, Early_monitor = val_accuracy
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 test samples
Model: "model_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 32, 32, 3)]       0         
_________________________________________________________________
block1_conv1 (Conv2D)        (None, 32, 32, 64)        1792      
_________________________________________________________________
block1_conv2 (Conv2D)        (None, 32, 32, 64)        36928     
_________________________________________________________________
block1_pool (MaxPooling2D)   (None, 16, 16, 64)        0         
_________________________________________________________________
dropout (Dropout)            (None, 16, 16, 64)        0         
_________________________________________________________________
block2_conv1 (Conv2D)        (None, 16, 16, 128)       73856     
_________________________________________________________________
block2_conv2 (Conv2D)        (None, 16, 16, 128)       147584    
_________________________________________________________________
block2_pool (MaxPooling2D)   (None, 8, 8, 128)         0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 8, 8, 128)         0         
_________________________________________________________________
block3_conv1 (Conv2D)        (None, 8, 8, 256)         295168    
_________________________________________________________________
block3_conv2 (Conv2D)        (None, 8, 8, 256)         590080    
_________________________________________________________________
block3_conv3 (Conv2D)        (None, 8, 8, 256)         590080    
_________________________________________________________________
block3_pool (MaxPooling2D)   (None, 4, 4, 256)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 4, 4, 256)         0         
_________________________________________________________________
block4_conv1 (Conv2D)        (None, 4, 4, 512)         1180160   
_________________________________________________________________
block4_conv2 (Conv2D)        (None, 4, 4, 512)         2359808   
_________________________________________________________________
block4_conv3 (Conv2D)        (None, 4, 4, 512)         2359808   
_________________________________________________________________
block4_pool (MaxPooling2D)   (None, 2, 2, 512)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 2, 2, 512)         0         
_________________________________________________________________
block5_conv1 (Conv2D)        (None, 2, 2, 512)         2359808   
_________________________________________________________________
block5_conv2 (Conv2D)        (None, 2, 2, 512)         2359808   
_________________________________________________________________
block5_conv3 (Conv2D)        (None, 2, 2, 512)         2359808   
_________________________________________________________________
block5_pool (MaxPooling2D)   (None, 1, 1, 512)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 1, 1, 512)         0         
_________________________________________________________________
flatten (Flatten)            (None, 512)               0         
_________________________________________________________________
fc1 (Dense)                  (None, 4096)              2101248   
_________________________________________________________________
dropout_5 (Dropout)          (None, 4096)              0         
_________________________________________________________________
fc2 (Dense)                  (None, 4096)              16781312  
_________________________________________________________________
dropout_6 (Dropout)          (None, 4096)              0         
_________________________________________________________________
predictions (Dense)          (None, 10)                40970     
=================================================================
Total params: 33,638,218
Trainable params: 33,638,218
Non-trainable params: 0
_________________________________________________________________
Start fitting monte carlo dropout model
Train for 1407 steps, validate for 157 steps
Epoch 1/500
1407/1407 - 25s - loss: 1.3054 - accuracy: 0.5372 - val_loss: 0.8309 - val_accuracy: 0.7136
Epoch 2/500
1407/1407 - 20s - loss: 0.8284 - accuracy: 0.7164 - val_loss: 0.7044 - val_accuracy: 0.7628
Epoch 3/500
1407/1407 - 20s - loss: 0.6938 - accuracy: 0.7638 - val_loss: 0.6322 - val_accuracy: 0.7854
Epoch 4/500
1407/1407 - 20s - loss: 0.5992 - accuracy: 0.7944 - val_loss: 0.5517 - val_accuracy: 0.8118
Epoch 5/500
1407/1407 - 20s - loss: 0.5330 - accuracy: 0.8189 - val_loss: 0.5440 - val_accuracy: 0.8118
Epoch 6/500
1407/1407 - 20s - loss: 0.4795 - accuracy: 0.8349 - val_loss: 0.5268 - val_accuracy: 0.8194
Epoch 7/500
1407/1407 - 20s - loss: 0.4285 - accuracy: 0.8544 - val_loss: 0.5123 - val_accuracy: 0.8296
Epoch 8/500
1407/1407 - 20s - loss: 0.3833 - accuracy: 0.8691 - val_loss: 0.4784 - val_accuracy: 0.8408
Epoch 9/500
1407/1407 - 20s - loss: 0.3451 - accuracy: 0.8823 - val_loss: 0.4762 - val_accuracy: 0.8430
Epoch 10/500
1407/1407 - 20s - loss: 0.3092 - accuracy: 0.8930 - val_loss: 0.4779 - val_accuracy: 0.8434
Epoch 11/500
1407/1407 - 20s - loss: 0.2738 - accuracy: 0.9061 - val_loss: 0.5187 - val_accuracy: 0.8376
Epoch 12/500
1407/1407 - 20s - loss: 0.2455 - accuracy: 0.9134 - val_loss: 0.4988 - val_accuracy: 0.8446
Epoch 13/500
1407/1407 - 20s - loss: 0.2172 - accuracy: 0.9241 - val_loss: 0.4760 - val_accuracy: 0.8510
Epoch 14/500
1407/1407 - 20s - loss: 0.1864 - accuracy: 0.9357 - val_loss: 0.5093 - val_accuracy: 0.8564
Epoch 15/500
1407/1407 - 20s - loss: 0.1681 - accuracy: 0.9422 - val_loss: 0.5305 - val_accuracy: 0.8542
Epoch 16/500
1407/1407 - 20s - loss: 0.1505 - accuracy: 0.9483 - val_loss: 0.5362 - val_accuracy: 0.8554
Epoch 17/500
1407/1407 - 20s - loss: 0.1322 - accuracy: 0.9542 - val_loss: 0.5345 - val_accuracy: 0.8524
Epoch 18/500
1407/1407 - 20s - loss: 0.1184 - accuracy: 0.9591 - val_loss: 0.5404 - val_accuracy: 0.8616
Epoch 19/500
1407/1407 - 20s - loss: 0.1050 - accuracy: 0.9640 - val_loss: 0.6051 - val_accuracy: 0.8510
Epoch 20/500
1407/1407 - 20s - loss: 0.0957 - accuracy: 0.9673 - val_loss: 0.5913 - val_accuracy: 0.8538
Epoch 21/500
1407/1407 - 20s - loss: 0.0875 - accuracy: 0.9701 - val_loss: 0.6380 - val_accuracy: 0.8500
Epoch 22/500
1407/1407 - 20s - loss: 0.0735 - accuracy: 0.9759 - val_loss: 0.6466 - val_accuracy: 0.8514
Epoch 23/500
1407/1407 - 20s - loss: 0.0698 - accuracy: 0.9764 - val_loss: 0.6742 - val_accuracy: 0.8524
Epoch 00023: early stopping
 0/50 [..............................] - ETA: 0s 8/50 [===>..........................] - ETA: 26s18/50 [=========>....................] - ETA: 18s28/50 [===============>..............] - ETA: 12s38/50 [=====================>........] - ETA: 6s 48/50 [===========================>..] - ETA: 1sMCDO accuracy: 71.4%
MCDO-ensemble accuracy: 71.9%
tf.Tensor(
[[944  19   6   8   0   0   0   2  11  10]
 [ 12 967   1   0   0   0   0   0   3  17]
 [133  36 694  54   1  39  21  17   3   2]
 [ 47  73  27 635   0 131  37  27   9  14]
 [122  75 114 152 160 161  49 150  10   7]
 [ 23  45  18 192   0 659  20  31   2  10]
 [ 23  93  23  38   0  31 772   4   7   9]
 [ 37  11  14  45   0  44   1 840   0   8]
 [213  57   4   4   0   3   0   1 705  13]
 [ 37 138   2   4   0   1   0   2   5 811]], shape=(10, 10), dtype=int32)
posterior mean: 0
true label: 0

class: 0; proba: 100.0%; var: 0.00% 
class: 1; proba: 0.0%; var: 0.00% 
class: 2; proba: 0.0%; var: 0.00% 
class: 3; proba: 0.0%; var: 0.00% 
class: 4; proba: 0.0%; var: 0.00% 
class: 5; proba: 0.0%; var: 0.00% 
class: 6; proba: 0.0%; var: 0.00% 
class: 7; proba: 0.0%; var: 0.00% 
class: 8; proba: 0.0%; var: 0.00% 
class: 9; proba: 0.0%; var: 0.00% 


###############################################################################
Peregrine Cluster
Job 11368494 for user 's2934833'
Finished at: Mon May 11 12:11:32 CEST 2020

Job details:
============

Name                : CIFDO
User                : s2934833
Partition           : gpu
Nodes               : pg-gpu09
Cores               : 12
State               : COMPLETED
Submit              : 2020-05-11T12:00:54
Start               : 2020-05-11T12:00:55
End                 : 2020-05-11T12:11:32
Reserved walltime   : 03:00:00
Used walltime       : 00:10:37
Used CPU time       : 00:09:14 (efficiency:  7.26%)
% User (Computation): 78.96%
% System (I/O)      : 21.04%
Mem reserved        : 62.50G/node
Max Mem used        : 3.56G (pg-gpu09)
Max Disk Write      : 153.60K (pg-gpu09)
Max Disk Read       : 5.83M (pg-gpu09)
Average GPU usage   : 61.0% (pg-gpu09)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/additional_information/scientific_output

################################################################################
