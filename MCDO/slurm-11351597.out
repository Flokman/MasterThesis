
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompic-2019b => FFTW/3.3.8-gompi-2019b
  2) OpenMPI/3.1.4-gcccuda-2019b => OpenMPI/3.1.4-GCC-8.3.0
  3) ScaLAPACK/2.0.2-gompic-2019b => ScaLAPACK/2.0.2-gompi-2019b
  4) SciPy-bundle/2019.10-fosscuda-2019b-Python-3.7.4 => SciPy-bundle/2019.10-foss-2019b-Python-3.7.4

2020-05-10 12:34:30.314385: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-10 12:34:37.390701: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-05-10 12:34:37.397674: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:34:37.398182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GRID V100D-32Q computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 31.88GiB deviceMemoryBandwidth: 836.37GiB/s
2020-05-10 12:34:37.398274: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-10 12:34:37.402940: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-10 12:34:37.406404: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-10 12:34:37.407803: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-10 12:34:37.411422: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-10 12:34:37.413641: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-10 12:34:37.419325: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-10 12:34:37.419526: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:34:37.420114: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:34:37.420613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-05-10 12:34:37.423186: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:34:37.423715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GRID V100D-32Q computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 31.88GiB deviceMemoryBandwidth: 836.37GiB/s
2020-05-10 12:34:37.423798: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-10 12:34:37.423873: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-10 12:34:37.423936: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-10 12:34:37.424016: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-10 12:34:37.424096: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-10 12:34:37.424158: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-10 12:34:37.424219: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-10 12:34:37.424355: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:34:37.424845: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:34:37.425260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-05-10 12:34:37.425366: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-10 12:34:38.080331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1096] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-05-10 12:34:38.080461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102]      0 
2020-05-10 12:34:38.080519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] 0:   N 
2020-05-10 12:34:38.080834: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:34:38.081598: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:34:38.082288: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:34:38.082859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1241] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 28652 MB memory) -> physical GPU (device: 0, name: GRID V100D-32Q, pci bus id: 0000:02:00.0, compute capability: 7.0)
2020-05-10 12:34:38.083246: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 12. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
2020-05-10 12:34:42.153578: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-10 12:34:42.408884: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-10 12:34:46.225057: I tensorflow/core/profiler/lib/profiler_session.cc:225] Profiler session started.
2020-05-10 12:34:46.225210: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1259] Profiler found 1 GPUs
2020-05-10 12:34:46.227933: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcupti.so.10.1
2020-05-10 12:34:46.328523: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1307] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_VIRTUALIZED_DEVICE_NOT_SUPPORTED
2020-05-10 12:34:46.329022: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1346] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI_ERROR_VIRTUALIZED_DEVICE_NOT_SUPPORTED
2020-05-10 12:34:46.535651: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1329] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI_ERROR_INVALID_PARAMETER
2020-05-10 12:34:46.535796: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:88]  GpuTracer has collected 0 callback api events and 0 activity events.
dataset_name = /Messidor2_PNG_256.hdf5, batch_size = 32, num_classes = 5, epochs = 500,
        MCDO_amount_of_predictions = 50, MCDO_batch_size = 250, test_img_idx = 273,
        train_test_split = 0.8, to_shuffle = False, augmentation = False, label_count = [1021, 270, 347, 75, 35],
        label_normalizer = True, save_augmentation_to_hdf5 = False, learn rate = 1e-05,
        add_dropout_inside = True, train_all_layers = False, weights_to_use = imagenet,
        mcdo = True, es_patience = 20, train_val_split = 0.9, Dropoutrates: [0.05, 0.1, 0.15, 0.2, 0.2, 0.2, 0.25, 0.25], MIN_DELTA = 0.005, Early_monitor = val_accuracy
x_train shape: (1398, 256, 256, 3)
1398 train samples
350 test samples
Model: "model_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 256, 3)]     0         
_________________________________________________________________
block1_conv1 (Conv2D)        (None, 256, 256, 64)      1792      
_________________________________________________________________
block1_conv2 (Conv2D)        (None, 256, 256, 64)      36928     
_________________________________________________________________
block1_pool (MaxPooling2D)   (None, 128, 128, 64)      0         
_________________________________________________________________
dropout (Dropout)            (None, 128, 128, 64)      0         
_________________________________________________________________
block2_conv1 (Conv2D)        (None, 128, 128, 128)     73856     
_________________________________________________________________
block2_conv2 (Conv2D)        (None, 128, 128, 128)     147584    
_________________________________________________________________
block2_pool (MaxPooling2D)   (None, 64, 64, 128)       0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 64, 128)       0         
_________________________________________________________________
block3_conv1 (Conv2D)        (None, 64, 64, 256)       295168    
_________________________________________________________________
block3_conv2 (Conv2D)        (None, 64, 64, 256)       590080    
_________________________________________________________________
block3_conv3 (Conv2D)        (None, 64, 64, 256)       590080    
_________________________________________________________________
block3_pool (MaxPooling2D)   (None, 32, 32, 256)       0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 32, 32, 256)       0         
_________________________________________________________________
block4_conv1 (Conv2D)        (None, 32, 32, 512)       1180160   
_________________________________________________________________
block4_conv2 (Conv2D)        (None, 32, 32, 512)       2359808   
_________________________________________________________________
block4_conv3 (Conv2D)        (None, 32, 32, 512)       2359808   
_________________________________________________________________
block4_pool (MaxPooling2D)   (None, 16, 16, 512)       0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 16, 512)       0         
_________________________________________________________________
block5_conv1 (Conv2D)        (None, 16, 16, 512)       2359808   
_________________________________________________________________
block5_conv2 (Conv2D)        (None, 16, 16, 512)       2359808   
_________________________________________________________________
block5_conv3 (Conv2D)        (None, 16, 16, 512)       2359808   
_________________________________________________________________
block5_pool (MaxPooling2D)   (None, 8, 8, 512)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 8, 8, 512)         0         
_________________________________________________________________
flatten (Flatten)            (None, 32768)             0         
_________________________________________________________________
fc1 (Dense)                  (None, 4096)              134221824 
_________________________________________________________________
dropout_5 (Dropout)          (None, 4096)              0         
_________________________________________________________________
fc2 (Dense)                  (None, 4096)              16781312  
_________________________________________________________________
dropout_6 (Dropout)          (None, 4096)              0         
_________________________________________________________________
predictions (Dense)          (None, 5)                 20485     
=================================================================
Total params: 165,738,309
Trainable params: 165,738,309
Non-trainable params: 0
_________________________________________________________________
Start fitting monte carlo dropout model
Train for 40 steps, validate for 5 steps
Epoch 1/500
40/40 - 21s - loss: 1.2874 - accuracy: 0.5262 - val_loss: 1.0591 - val_accuracy: 0.5857
Epoch 2/500
40/40 - 16s - loss: 1.2002 - accuracy: 0.5612 - val_loss: 1.0099 - val_accuracy: 0.6286
Epoch 3/500
40/40 - 14s - loss: 1.1476 - accuracy: 0.5612 - val_loss: 1.0094 - val_accuracy: 0.5929
Epoch 4/500
40/40 - 8s - loss: 1.1349 - accuracy: 0.5533 - val_loss: 1.0261 - val_accuracy: 0.6143
Epoch 5/500
40/40 - 13s - loss: 1.1196 - accuracy: 0.5620 - val_loss: 0.9819 - val_accuracy: 0.6286
Epoch 6/500
40/40 - 14s - loss: 1.0979 - accuracy: 0.5620 - val_loss: 0.9340 - val_accuracy: 0.6000
Epoch 7/500
40/40 - 14s - loss: 1.0860 - accuracy: 0.5700 - val_loss: 0.9325 - val_accuracy: 0.6143
Epoch 8/500
40/40 - 8s - loss: 1.0914 - accuracy: 0.5700 - val_loss: 0.9727 - val_accuracy: 0.6000
Epoch 9/500
40/40 - 8s - loss: 1.0527 - accuracy: 0.5859 - val_loss: 0.9444 - val_accuracy: 0.6357
Epoch 10/500
40/40 - 15s - loss: 1.0480 - accuracy: 0.5938 - val_loss: 0.9273 - val_accuracy: 0.6357
Epoch 11/500
40/40 - 8s - loss: 1.0119 - accuracy: 0.6025 - val_loss: 0.9412 - val_accuracy: 0.6143
Epoch 12/500
40/40 - 8s - loss: 1.0161 - accuracy: 0.5978 - val_loss: 0.9317 - val_accuracy: 0.6286
Epoch 13/500
40/40 - 8s - loss: 0.9936 - accuracy: 0.6129 - val_loss: 1.0029 - val_accuracy: 0.5643
Epoch 14/500
40/40 - 8s - loss: 0.9939 - accuracy: 0.6081 - val_loss: 0.9694 - val_accuracy: 0.6071
Epoch 15/500
40/40 - 13s - loss: 0.9570 - accuracy: 0.6224 - val_loss: 0.9103 - val_accuracy: 0.6071
Epoch 16/500
40/40 - 13s - loss: 0.9451 - accuracy: 0.6343 - val_loss: 0.8883 - val_accuracy: 0.6071
Epoch 17/500
40/40 - 8s - loss: 0.9125 - accuracy: 0.6320 - val_loss: 0.9759 - val_accuracy: 0.5929
Epoch 18/500
40/40 - 8s - loss: 0.8693 - accuracy: 0.6518 - val_loss: 0.9687 - val_accuracy: 0.5571
Epoch 19/500
40/40 - 8s - loss: 0.8516 - accuracy: 0.6590 - val_loss: 0.9226 - val_accuracy: 0.6071
Epoch 20/500
40/40 - 8s - loss: 0.8307 - accuracy: 0.6638 - val_loss: 0.9346 - val_accuracy: 0.5714
Epoch 21/500
40/40 - 8s - loss: 0.7827 - accuracy: 0.6860 - val_loss: 1.0623 - val_accuracy: 0.6214
Epoch 22/500
40/40 - 8s - loss: 0.7827 - accuracy: 0.6900 - val_loss: 1.0167 - val_accuracy: 0.5571
Epoch 23/500
40/40 - 8s - loss: 0.6946 - accuracy: 0.7345 - val_loss: 1.0310 - val_accuracy: 0.6143
Epoch 24/500
40/40 - 8s - loss: 0.6969 - accuracy: 0.7250 - val_loss: 0.9927 - val_accuracy: 0.5714
Epoch 25/500
40/40 - 8s - loss: 0.6512 - accuracy: 0.7432 - val_loss: 1.0406 - val_accuracy: 0.5857
Epoch 26/500
40/40 - 8s - loss: 0.5999 - accuracy: 0.7544 - val_loss: 1.0236 - val_accuracy: 0.5500
Epoch 27/500
40/40 - 8s - loss: 0.6071 - accuracy: 0.7432 - val_loss: 1.0090 - val_accuracy: 0.5929
Epoch 28/500
40/40 - 8s - loss: 0.5510 - accuracy: 0.7949 - val_loss: 1.0841 - val_accuracy: 0.5643
Epoch 29/500
40/40 - 8s - loss: 0.5394 - accuracy: 0.7822 - val_loss: 1.0511 - val_accuracy: 0.5714
Epoch 00029: early stopping
 0/50 [..............................] - ETA: 0s 1/50 [..............................] - ETA: 6:19 8/50 [===>..........................] - ETA: 1:0715/50 [========>.....................] - ETA: 41s 22/50 [============>.................] - ETA: 29s29/50 [================>.............] - ETA: 20s36/50 [====================>.........] - ETA: 12s43/50 [========================>.....] - ETA: 6s MCDO accuracy: 59.6%
MCDO-ensemble accuracy: 61.1%
tf.Tensor(
[[200   0   2   6   0]
 [ 46   1   3   1   0]
 [ 52   1   4  11   0]
 [  7   0   0   9   0]
 [  4   0   0   3   0]], shape=(5, 5), dtype=int32)
posterior mean: 0
true label: 2

class: 0; proba: 83.1%; var: 36.44% 
class: 1; proba: 1.3%; var: 9.18% 
class: 2; proba: 4.0%; var: 19.58% 
class: 3; proba: 11.6%; var: 31.44% 
class: 4; proba: 0.0%; var: 0.00% 


###############################################################################
Peregrine Cluster
Job 11351597 for user 's2934833'
Finished at: Sun May 10 12:40:31 CEST 2020

Job details:
============

Name                : MESDO
User                : s2934833
Partition           : gpu
Nodes               : pg-gpu37
Cores               : 12
State               : COMPLETED
Submit              : 2020-05-10T12:34:25
Start               : 2020-05-10T12:34:25
End                 : 2020-05-10T12:40:31
Reserved walltime   : 03:00:00
Used walltime       : 00:06:06
Used CPU time       : 00:04:58 (efficiency:  6.79%)
% User (Computation): 65.65%
% System (I/O)      : 34.35%
Mem reserved        : 62.50G/node
Max Mem used        : 5.36G (pg-gpu37)
Max Disk Write      : 153.60K (pg-gpu37)
Max Disk Read       : 5.83M (pg-gpu37)
Average GPU usage   : 44.7% (pg-gpu37)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/additional_information/scientific_output

################################################################################
