
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompic-2019b => FFTW/3.3.8-gompi-2019b
  2) OpenMPI/3.1.4-gcccuda-2019b => OpenMPI/3.1.4-GCC-8.3.0
  3) ScaLAPACK/2.0.2-gompic-2019b => ScaLAPACK/2.0.2-gompi-2019b
  4) SciPy-bundle/2019.10-fosscuda-2019b-Python-3.7.4 => SciPy-bundle/2019.10-foss-2019b-Python-3.7.4

2020-05-07 11:32:38.271970: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-07 11:32:45.133998: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-05-07 11:32:45.140781: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-07 11:32:45.141305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GRID V100D-32Q computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 31.88GiB deviceMemoryBandwidth: 836.37GiB/s
2020-05-07 11:32:45.141399: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-07 11:32:45.145986: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-07 11:32:45.149357: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-07 11:32:45.150781: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-07 11:32:45.154346: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-07 11:32:45.156530: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-07 11:32:45.162275: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-07 11:32:45.162482: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-07 11:32:45.163048: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-07 11:32:45.163488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-05-07 11:32:45.166382: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-07 11:32:45.166839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GRID V100D-32Q computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 31.88GiB deviceMemoryBandwidth: 836.37GiB/s
2020-05-07 11:32:45.166929: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-07 11:32:45.167010: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-07 11:32:45.167075: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-07 11:32:45.167142: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-07 11:32:45.167206: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-07 11:32:45.167271: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-07 11:32:45.167335: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-07 11:32:45.167486: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-07 11:32:45.168006: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-07 11:32:45.168422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-05-07 11:32:45.168519: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-07 11:32:45.788570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1096] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-05-07 11:32:45.788703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102]      0 
2020-05-07 11:32:45.788760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] 0:   N 
2020-05-07 11:32:45.789063: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-07 11:32:45.789741: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-07 11:32:45.790286: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-07 11:32:45.790749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1241] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 28652 MB memory) -> physical GPU (device: 0, name: GRID V100D-32Q, pci bus id: 0000:02:00.0, compute capability: 7.0)
2020-05-07 11:32:45.791093: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 12. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
2020-05-07 11:32:50.471816: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-07 11:32:50.726065: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-07 11:32:54.546162: I tensorflow/core/profiler/lib/profiler_session.cc:225] Profiler session started.
2020-05-07 11:32:54.546325: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1259] Profiler found 1 GPUs
2020-05-07 11:32:54.548774: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcupti.so.10.1
2020-05-07 11:32:54.649365: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1307] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_VIRTUALIZED_DEVICE_NOT_SUPPORTED
2020-05-07 11:32:54.649939: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1346] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI_ERROR_VIRTUALIZED_DEVICE_NOT_SUPPORTED
2020-05-07 11:32:54.857202: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1329] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI_ERROR_INVALID_PARAMETER
2020-05-07 11:32:54.857360: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:88]  GpuTracer has collected 0 callback api events and 0 activity events.
WARNING:tensorflow:Method (on_train_batch_end) is slow compared to the batch update (0.563396). Check your callbacks.
dataset_name = /Messidor2_PNG_AUG_256.hdf5, batch_size = 32, num_classes = 5, epochs = 500,
        MCDO_amount_of_predictions = 50, MCDO_batch_size = 250, test_img_idx = 747,
        train_test_split = 0.8, to_shuffle = False, augmentation = False, label_count = [1261, 1416, 1397, 1455, 1463],
        label_normalizer = True, save_augmentation_to_hdf5 = False, learn rate = 1e-05,
        add_dropout_inside = True, train_all_layers = False, weights_to_use = imagenet,
        mcdo = True, es_patience = 10, train_val_split = 0.9, Dropoutrates: [0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.3, 0.4], MIN_DELTA = 0.005, Early_monitor = val_accuracy
x_train shape: (5593, 256, 256, 3)
5593 train samples
1399 test samples
Model: "model_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 256, 3)]     0         
_________________________________________________________________
block1_conv1 (Conv2D)        (None, 256, 256, 64)      1792      
_________________________________________________________________
block1_conv2 (Conv2D)        (None, 256, 256, 64)      36928     
_________________________________________________________________
block1_pool (MaxPooling2D)   (None, 128, 128, 64)      0         
_________________________________________________________________
dropout (Dropout)            (None, 128, 128, 64)      0         
_________________________________________________________________
block2_conv1 (Conv2D)        (None, 128, 128, 128)     73856     
_________________________________________________________________
block2_conv2 (Conv2D)        (None, 128, 128, 128)     147584    
_________________________________________________________________
block2_pool (MaxPooling2D)   (None, 64, 64, 128)       0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 64, 64, 128)       0         
_________________________________________________________________
block3_conv1 (Conv2D)        (None, 64, 64, 256)       295168    
_________________________________________________________________
block3_conv2 (Conv2D)        (None, 64, 64, 256)       590080    
_________________________________________________________________
block3_conv3 (Conv2D)        (None, 64, 64, 256)       590080    
_________________________________________________________________
block3_pool (MaxPooling2D)   (None, 32, 32, 256)       0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 32, 32, 256)       0         
_________________________________________________________________
block4_conv1 (Conv2D)        (None, 32, 32, 512)       1180160   
_________________________________________________________________
block4_conv2 (Conv2D)        (None, 32, 32, 512)       2359808   
_________________________________________________________________
block4_conv3 (Conv2D)        (None, 32, 32, 512)       2359808   
_________________________________________________________________
block4_pool (MaxPooling2D)   (None, 16, 16, 512)       0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 16, 16, 512)       0         
_________________________________________________________________
block5_conv1 (Conv2D)        (None, 16, 16, 512)       2359808   
_________________________________________________________________
block5_conv2 (Conv2D)        (None, 16, 16, 512)       2359808   
_________________________________________________________________
block5_conv3 (Conv2D)        (None, 16, 16, 512)       2359808   
_________________________________________________________________
block5_pool (MaxPooling2D)   (None, 8, 8, 512)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 8, 8, 512)         0         
_________________________________________________________________
flatten (Flatten)            (None, 32768)             0         
_________________________________________________________________
fc1 (Dense)                  (None, 4096)              134221824 
_________________________________________________________________
dropout_5 (Dropout)          (None, 4096)              0         
_________________________________________________________________
fc2 (Dense)                  (None, 4096)              16781312  
_________________________________________________________________
dropout_6 (Dropout)          (None, 4096)              0         
_________________________________________________________________
predictions (Dense)          (None, 5)                 20485     
=================================================================
Total params: 165,738,309
Trainable params: 165,738,309
Non-trainable params: 0
_________________________________________________________________
Start fitting monte carlo dropout model
Train for 158 steps, validate for 18 steps
Epoch 1/500
158/158 - 46s - loss: 1.4214 - accuracy: 0.3559 - val_loss: 1.8468 - val_accuracy: 0.1429
Epoch 2/500
158/158 - 39s - loss: 1.2840 - accuracy: 0.4012 - val_loss: 1.7292 - val_accuracy: 0.0929
Epoch 3/500
158/158 - 34s - loss: 1.2354 - accuracy: 0.4230 - val_loss: 1.7810 - val_accuracy: 0.0625
Epoch 4/500
158/158 - 34s - loss: 1.2022 - accuracy: 0.4540 - val_loss: 1.8285 - val_accuracy: 0.1089
Epoch 5/500
158/158 - 38s - loss: 1.1515 - accuracy: 0.4924 - val_loss: 1.4887 - val_accuracy: 0.3482
Epoch 6/500
158/158 - 39s - loss: 1.0599 - accuracy: 0.5484 - val_loss: 1.1765 - val_accuracy: 0.5661
Epoch 7/500
158/158 - 34s - loss: 0.9766 - accuracy: 0.5873 - val_loss: 1.4613 - val_accuracy: 0.4357
Epoch 8/500
158/158 - 38s - loss: 0.9037 - accuracy: 0.6306 - val_loss: 1.1035 - val_accuracy: 0.6661
Epoch 9/500
158/158 - 39s - loss: 0.8533 - accuracy: 0.6525 - val_loss: 0.8274 - val_accuracy: 0.7536
Epoch 10/500
158/158 - 34s - loss: 0.7837 - accuracy: 0.6799 - val_loss: 1.1079 - val_accuracy: 0.6679
Epoch 11/500
158/158 - 38s - loss: 0.7404 - accuracy: 0.6970 - val_loss: 0.7470 - val_accuracy: 0.7911
Epoch 12/500
158/158 - 34s - loss: 0.6821 - accuracy: 0.7286 - val_loss: 0.9257 - val_accuracy: 0.7482
Epoch 13/500
158/158 - 34s - loss: 0.6099 - accuracy: 0.7598 - val_loss: 1.1104 - val_accuracy: 0.6393
Epoch 14/500
158/158 - 39s - loss: 0.5578 - accuracy: 0.7808 - val_loss: 0.6253 - val_accuracy: 0.8250
Epoch 15/500
158/158 - 34s - loss: 0.5157 - accuracy: 0.7997 - val_loss: 0.6862 - val_accuracy: 0.8179
Epoch 16/500
158/158 - 34s - loss: 0.4594 - accuracy: 0.8232 - val_loss: 0.7052 - val_accuracy: 0.8196
Epoch 17/500
158/158 - 34s - loss: 0.4037 - accuracy: 0.8476 - val_loss: 0.8709 - val_accuracy: 0.7786
Epoch 18/500
158/158 - 34s - loss: 0.3935 - accuracy: 0.8506 - val_loss: 0.9107 - val_accuracy: 0.7500
Epoch 19/500
158/158 - 34s - loss: 0.3357 - accuracy: 0.8770 - val_loss: 0.6598 - val_accuracy: 0.8357
Epoch 20/500
158/158 - 39s - loss: 0.3079 - accuracy: 0.8879 - val_loss: 0.6120 - val_accuracy: 0.8625
Epoch 21/500
158/158 - 34s - loss: 0.2832 - accuracy: 0.8951 - val_loss: 0.6212 - val_accuracy: 0.8661
Epoch 22/500
158/158 - 34s - loss: 0.2580 - accuracy: 0.9058 - val_loss: 0.6675 - val_accuracy: 0.8429
Epoch 23/500
158/158 - 34s - loss: 0.2291 - accuracy: 0.9207 - val_loss: 0.6722 - val_accuracy: 0.8714
Epoch 24/500
158/158 - 34s - loss: 0.2105 - accuracy: 0.9261 - val_loss: 0.7085 - val_accuracy: 0.8589
Epoch 25/500
158/158 - 34s - loss: 0.1952 - accuracy: 0.9287 - val_loss: 0.6863 - val_accuracy: 0.8750
Epoch 26/500
158/158 - 39s - loss: 0.1954 - accuracy: 0.9289 - val_loss: 0.5981 - val_accuracy: 0.9000
Epoch 27/500
158/158 - 34s - loss: 0.1782 - accuracy: 0.9372 - val_loss: 0.6604 - val_accuracy: 0.8768
Epoch 28/500
158/158 - 34s - loss: 0.1600 - accuracy: 0.9452 - val_loss: 0.7389 - val_accuracy: 0.8518
Epoch 29/500
158/158 - 34s - loss: 0.1482 - accuracy: 0.9477 - val_loss: 0.6288 - val_accuracy: 0.8929
Epoch 30/500
158/158 - 39s - loss: 0.1383 - accuracy: 0.9493 - val_loss: 0.5667 - val_accuracy: 0.9179
Epoch 31/500
158/158 - 34s - loss: 0.1335 - accuracy: 0.9541 - val_loss: 0.6761 - val_accuracy: 0.9000
Epoch 32/500
158/158 - 34s - loss: 0.1278 - accuracy: 0.9557 - val_loss: 0.6648 - val_accuracy: 0.9125
Epoch 33/500
158/158 - 34s - loss: 0.1216 - accuracy: 0.9565 - val_loss: 0.6152 - val_accuracy: 0.9107
Epoch 34/500
158/158 - 34s - loss: 0.1102 - accuracy: 0.9644 - val_loss: 0.5856 - val_accuracy: 0.9107
Epoch 35/500
158/158 - 34s - loss: 0.1049 - accuracy: 0.9626 - val_loss: 0.6589 - val_accuracy: 0.8946
Epoch 36/500
158/158 - 34s - loss: 0.0958 - accuracy: 0.9686 - val_loss: 0.6376 - val_accuracy: 0.8982
Epoch 37/500
158/158 - 34s - loss: 0.1011 - accuracy: 0.9626 - val_loss: 0.6289 - val_accuracy: 0.9018
Epoch 38/500
158/158 - 34s - loss: 0.1005 - accuracy: 0.9617 - val_loss: 0.5857 - val_accuracy: 0.9000
Epoch 39/500
158/158 - 34s - loss: 0.0907 - accuracy: 0.9690 - val_loss: 0.5850 - val_accuracy: 0.9000
Epoch 40/500
158/158 - 34s - loss: 0.0849 - accuracy: 0.9690 - val_loss: 0.5962 - val_accuracy: 0.9161
Epoch 00040: early stopping
 0/50 [..............................] - ETA: 0s 1/50 [..............................] - ETA: 8:49 3/50 [>.............................] - ETA: 4:21 5/50 [==>...........................] - ETA: 3:23 7/50 [===>..........................] - ETA: 2:55 9/50 [====>.........................] - ETA: 2:3611/50 [=====>........................] - ETA: 2:2213/50 [======>.......................] - ETA: 2:1115/50 [========>.....................] - ETA: 2:0117/50 [=========>....................] - ETA: 1:5219/50 [==========>...................] - ETA: 1:4321/50 [===========>..................] - ETA: 1:3623/50 [============>.................] - ETA: 1:2825/50 [==============>...............] - ETA: 1:2127/50 [===============>..............] - ETA: 1:1429/50 [================>.............] - ETA: 1:0731/50 [=================>............] - ETA: 1:0033/50 [==================>...........] - ETA: 53s 35/50 [====================>.........] - ETA: 47s37/50 [=====================>........] - ETA: 40s39/50 [======================>.......] - ETA: 34s41/50 [=======================>......] - ETA: 28s43/50 [========================>.....] - ETA: 21s45/50 [==========================>...] - ETA: 15s47/50 [===========================>..] - ETA: 9s 49/50 [============================>.] - ETA: 3sMCDO accuracy: 0.2%
MCDO-ensemble accuracy: 0.0%
tf.Tensor(
[[  0   0   0   0   0]
 [  0   0   0   0   0]
 [  0   0   0   0   0]
 [  0   0   0   0   0]
 [357  94 426 522   0]], shape=(5, 5), dtype=int32)
posterior mean: 0
true label: 4

class: 0; proba: 98.0%; var: 13.96% 
class: 1; proba: 0.0%; var: 0.00% 
class: 2; proba: 0.0%; var: 0.00% 
class: 3; proba: 2.0%; var: 13.96% 
class: 4; proba: 0.0%; var: 0.00% 


###############################################################################
Peregrine Cluster
Job 11309805 for user 's2934833'
Finished at: Thu May  7 11:59:03 CEST 2020

Job details:
============

Name                : MESDO
User                : s2934833
Partition           : gpu
Nodes               : pg-gpu14
Cores               : 12
State               : COMPLETED
Submit              : 2020-05-07T11:29:01
Start               : 2020-05-07T11:32:32
End                 : 2020-05-07T11:59:02
Reserved walltime   : 03:00:00
Used walltime       : 00:26:30
Used CPU time       : 00:22:09 (efficiency:  6.97%)
% User (Computation): 68.57%
% System (I/O)      : 31.43%
Mem reserved        : 62.50G/node
Max Mem used        : 12.79G (pg-gpu14)
Max Disk Write      : 153.60K (pg-gpu14)
Max Disk Read       : 5.83M (pg-gpu14)
Average GPU usage   : 86.4% (pg-gpu14)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/additional_information/scientific_output

################################################################################
