
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompic-2019b => FFTW/3.3.8-gompi-2019b
  2) OpenMPI/3.1.4-gcccuda-2019b => OpenMPI/3.1.4-GCC-8.3.0
  3) ScaLAPACK/2.0.2-gompic-2019b => ScaLAPACK/2.0.2-gompi-2019b
  4) SciPy-bundle/2019.10-fosscuda-2019b-Python-3.7.4 => SciPy-bundle/2019.10-foss-2019b-Python-3.7.4

2020-03-04 14:49:37.030337: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-03-04 14:49:43.828211: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-03-04 14:49:43.835862: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-04 14:49:43.836449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GRID V100D-32Q computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 31.87GiB deviceMemoryBandwidth: 836.37GiB/s
2020-03-04 14:49:43.836501: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-03-04 14:49:43.841544: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-03-04 14:49:43.845146: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-03-04 14:49:43.846556: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-03-04 14:49:43.850380: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-03-04 14:49:43.852719: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-03-04 14:49:43.858964: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-03-04 14:49:43.859148: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-04 14:49:43.859719: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-04 14:49:43.860113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-03-04 14:49:43.862985: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-04 14:49:43.863445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GRID V100D-32Q computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 31.87GiB deviceMemoryBandwidth: 836.37GiB/s
2020-03-04 14:49:43.863494: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-03-04 14:49:43.863530: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-03-04 14:49:43.863552: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-03-04 14:49:43.863572: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-03-04 14:49:43.863592: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-03-04 14:49:43.863612: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-03-04 14:49:43.863632: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-03-04 14:49:43.863731: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-04 14:49:43.864162: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-04 14:49:43.864531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-03-04 14:49:43.864585: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-03-04 14:49:44.655860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1096] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-03-04 14:49:44.655948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102]      0 
2020-03-04 14:49:44.655964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] 0:   N 
2020-03-04 14:49:44.656235: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-04 14:49:44.657378: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-04 14:49:44.657934: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-04 14:49:44.658412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1241] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 28652 MB memory) -> physical GPU (device: 0, name: GRID V100D-32Q, pci bus id: 0000:02:00.0, compute capability: 7.0)
2020-03-04 14:49:44.658831: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
2020-03-04 14:49:47.972183: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-03-04 14:49:48.340157: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-03-04 14:49:53.452761: I tensorflow/core/profiler/lib/profiler_session.cc:225] Profiler session started.
2020-03-04 14:49:53.452946: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1259] Profiler found 1 GPUs
2020-03-04 14:49:53.456156: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcupti.so.10.1
2020-03-04 14:49:53.556981: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1307] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_VIRTUALIZED_DEVICE_NOT_SUPPORTED
2020-03-04 14:49:53.557759: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1346] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI_ERROR_VIRTUALIZED_DEVICE_NOT_SUPPORTED
2020-03-04 14:49:53.760462: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1329] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI_ERROR_INVALID_PARAMETER
2020-03-04 14:49:53.760633: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:88]  GpuTracer has collected 0 callback api events and 0 activity events.
Random seed for replication: 782
dataset_name = /Messidor2_PNG_256.hdf5, batch_size = 32, num_classes = 5, epochs = 500,
        MCBN_amount_of_predictions = 50, test_img_idx = 210,
        train_test_split = 0.8, to_shuffle = True, augmentation = False, label_count = [1021, 270, 347, 75, 35],
        label_normalizer = True, save_augmentation_to_hdf5 = True, learn rate = 1e-05,
        train_all_layers = True, weights_to_use = None,
        es_patience = 30, train_val_split = 0.9
x_train shape: (1398, 256, 256, 3)
1398 train samples
350 test samples
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 256, 256, 3) 0                                            
__________________________________________________________________________________________________
block1_conv1 (Conv2D)           (None, 256, 256, 64) 1792        input_1[0][0]                    
__________________________________________________________________________________________________
block1_conv2 (Conv2D)           (None, 256, 256, 64) 36928       block1_conv1[1][0]               
__________________________________________________________________________________________________
block1_pool (MaxPooling2D)      (None, 128, 128, 64) 0           block1_conv2[1][0]               
__________________________________________________________________________________________________
block2_conv1 (Conv2D)           (None, 128, 128, 128 73856       block1_pool[1][0]                
__________________________________________________________________________________________________
block2_conv2 (Conv2D)           (None, 128, 128, 128 147584      block2_conv1[1][0]               
__________________________________________________________________________________________________
block2_pool (MaxPooling2D)      (None, 64, 64, 128)  0           block2_conv2[1][0]               
__________________________________________________________________________________________________
block3_conv1 (Conv2D)           (None, 64, 64, 256)  295168      block2_pool[1][0]                
__________________________________________________________________________________________________
block3_conv2 (Conv2D)           (None, 64, 64, 256)  590080      block3_conv1[1][0]               
__________________________________________________________________________________________________
block3_conv3 (Conv2D)           (None, 64, 64, 256)  590080      block3_conv2[1][0]               
__________________________________________________________________________________________________
block3_pool (MaxPooling2D)      (None, 32, 32, 256)  0           block3_conv3[1][0]               
__________________________________________________________________________________________________
block4_conv1 (Conv2D)           (None, 32, 32, 512)  1180160     block3_pool[1][0]                
__________________________________________________________________________________________________
block4_conv2 (Conv2D)           (None, 32, 32, 512)  2359808     block4_conv1[1][0]               
__________________________________________________________________________________________________
block4_conv3 (Conv2D)           (None, 32, 32, 512)  2359808     block4_conv2[1][0]               
__________________________________________________________________________________________________
block4_pool (MaxPooling2D)      (None, 16, 16, 512)  0           block4_conv3[1][0]               
__________________________________________________________________________________________________
block5_conv1 (Conv2D)           (None, 16, 16, 512)  2359808     block4_pool[1][0]                
__________________________________________________________________________________________________
block5_conv2 (Conv2D)           (None, 16, 16, 512)  2359808     block5_conv1[1][0]               
__________________________________________________________________________________________________
block5_conv3 (Conv2D)           (None, 16, 16, 512)  2359808     block5_conv2[1][0]               
__________________________________________________________________________________________________
block5_pool (MaxPooling2D)      (None, 8, 8, 512)    0           block5_conv3[1][0]               
__________________________________________________________________________________________________
flatten (Flatten)               (None, 32768)        0           block5_pool[1][0]                
__________________________________________________________________________________________________
fc1 (Dense)                     (None, 4096)         134221824   flatten[0][0]                    
__________________________________________________________________________________________________
fc2 (Dense)                     (None, 4096)         16781312    fc1[0][0]                        
__________________________________________________________________________________________________
dense (Dense)                   (None, 5)            20485       fc2[0][0]                        
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 5)            20485       fc2[0][0]                        
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 10)           0           dense[0][0]                      
                                                                 dense_1[0][0]                    
==================================================================================================
Total params: 165,758,794
Trainable params: 165,758,794
Non-trainable params: 0
__________________________________________________________________________________________________
Start fitting
Train for 40 steps, validate for 5 steps
Epoch 1/500
40/40 - 17s - loss: 10.1431 - mean_pred: -1.7939e-01 - val_loss: 16.1181 - val_mean_pred: -6.2333e-01
Epoch 2/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.4767e-01 - val_loss: 16.1181 - val_mean_pred: -7.7454e-01
Epoch 3/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9004e-01 - val_loss: 16.1181 - val_mean_pred: -7.7782e-01
Epoch 4/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 5/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 6/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 7/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 8/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 9/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 10/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 11/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 12/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 13/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 14/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 15/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 16/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 17/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 18/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 19/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 20/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 21/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 22/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 23/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 24/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 25/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 26/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 27/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 28/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 29/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 30/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 31/500
40/40 - 8s - loss: 16.1181 - mean_pred: -7.9086e-01 - val_loss: 16.1181 - val_mean_pred: -7.7784e-01
Epoch 00031: early stopping
##############################################################
Tensor("IteratorGetNext:1", shape=(None, 10), dtype=float32) Tensor("model/concatenate/concat:0", shape=(None, 10), dtype=float32)
Tensor("loss/concatenate_loss/Mean:0", shape=(None,), dtype=float32)
##############################################################
Test loss: 91646.3978125
Test accuracy: -208.46762
True label: 0
[1. 0. 0. 0. 0.]
Predicted value: 1.0, predicted class: 0
[-360.62207 -384.77545 -331.68158 -398.58743 -364.36972]
Min uncertainty: -398.5874328613281, min index: 3

Value of predicted class: -360.6220703125
##############################################################
True label: 0
[1. 0. 0. 0. 0.]
Predicted value: 1.0, predicted class: 0
[-426.85144 -452.851   -389.72943 -468.4612  -428.3316 ]
Min uncertainty: -468.4612121582031, min index: 3

Value of predicted class: -426.8514404296875
##############################################################
True label: 2
[1. 0. 0. 0. 0.]
Predicted value: 1.0, predicted class: 0
[-468.66382 -498.9083  -430.1204  -516.0462  -472.6685 ]
Min uncertainty: -516.0462036132812, min index: 3

Value of predicted class: -468.663818359375
##############################################################
True label: 2
[1.000000e+00 0.000000e+00 5.540673e-38 0.000000e+00 0.000000e+00]
Predicted value: 1.0, predicted class: 0
[-306.3154  -322.1111  -277.82373 -332.51147 -304.64566]
Min uncertainty: -332.511474609375, min index: 3

Value of predicted class: -306.3153991699219
##############################################################
True label: 2
[1. 0. 0. 0. 0.]
Predicted value: 1.0, predicted class: 0
[-558.2646  -592.14685 -509.95563 -612.41016 -562.2556 ]
Min uncertainty: -612.41015625, min index: 3

Value of predicted class: -558.2645874023438
##############################################################


###############################################################################
Peregrine Cluster
Job 9900415 for user 's2934833'
Finished at: Wed Mar  4 14:54:14 CET 2020

Job details:
============

Name                : test
User                : s2934833
Partition           : gpu
Nodes               : pg-gpu30
Cores               : 12
State               : COMPLETED
Submit              : 2020-03-04T14:48:56
Start               : 2020-03-04T14:49:30
End                 : 2020-03-04T14:54:14
Reserved walltime   : 02:00:00
Used walltime       : 00:04:44
Used CPU time       : 00:03:55 (efficiency:  6.92%)
% User (Computation): 70.45%
% System (I/O)      : 29.55%
Mem reserved        : 32000M/node
Max Mem used        : 4.61G (pg-gpu30)
Max Disk Write      : 153.60K (pg-gpu30)
Max Disk Read       : 5.33M (pg-gpu30)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/additional_information/scientific_output

################################################################################
