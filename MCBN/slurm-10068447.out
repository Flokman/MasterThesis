
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompic-2019b => FFTW/3.3.8-gompi-2019b
  2) OpenMPI/3.1.4-gcccuda-2019b => OpenMPI/3.1.4-GCC-8.3.0
  3) ScaLAPACK/2.0.2-gompic-2019b => ScaLAPACK/2.0.2-gompi-2019b
  4) SciPy-bundle/2019.10-fosscuda-2019b-Python-3.7.4 => SciPy-bundle/2019.10-foss-2019b-Python-3.7.4

2020-03-12 18:28:43.605048: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-03-12 18:29:05.142800: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-03-12 18:29:05.149887: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-12 18:29:05.150524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GRID V100D-32Q computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 31.87GiB deviceMemoryBandwidth: 836.37GiB/s
2020-03-12 18:29:05.150574: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-03-12 18:29:05.155205: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-03-12 18:29:05.158662: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-03-12 18:29:05.160156: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-03-12 18:29:05.163714: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-03-12 18:29:05.165965: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-03-12 18:29:05.171926: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-03-12 18:29:05.172116: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-12 18:29:05.172766: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-12 18:29:05.173471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-03-12 18:29:05.176248: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-12 18:29:05.176706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GRID V100D-32Q computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 31.87GiB deviceMemoryBandwidth: 836.37GiB/s
2020-03-12 18:29:05.176749: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-03-12 18:29:05.176784: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-03-12 18:29:05.176806: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-03-12 18:29:05.176826: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-03-12 18:29:05.176846: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-03-12 18:29:05.176867: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-03-12 18:29:05.176887: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-03-12 18:29:05.176997: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-12 18:29:05.177544: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-12 18:29:05.177959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-03-12 18:29:05.178025: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-03-12 18:29:05.938930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1096] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-03-12 18:29:05.939031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102]      0 
2020-03-12 18:29:05.939047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] 0:   N 
2020-03-12 18:29:05.939350: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-12 18:29:05.940111: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-12 18:29:05.940749: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-12 18:29:05.941328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1241] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 28652 MB memory) -> physical GPU (device: 0, name: GRID V100D-32Q, pci bus id: 0000:02:00.0, compute capability: 7.0)
2020-03-12 18:29:05.941754: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
2020-03-12 18:29:18.065556: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-03-12 18:29:18.442922: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-03-12 18:29:24.790353: I tensorflow/core/profiler/lib/profiler_session.cc:225] Profiler session started.
2020-03-12 18:29:24.790461: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1259] Profiler found 1 GPUs
2020-03-12 18:29:24.792954: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcupti.so.10.1
2020-03-12 18:29:24.893758: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1307] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_VIRTUALIZED_DEVICE_NOT_SUPPORTED
2020-03-12 18:29:24.894348: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1346] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI_ERROR_VIRTUALIZED_DEVICE_NOT_SUPPORTED
2020-03-12 18:29:25.336624: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1329] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI_ERROR_INVALID_PARAMETER
2020-03-12 18:29:25.336721: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:88]  GpuTracer has collected 0 callback api events and 0 activity events.
Random seed for replication: 642
dataset_name = /Messidor2_PNG_AUG_256.hdf5, batch_size = 64, num_classes = 5, epochs = 150,
        MCBN_PREDICTIONS = 250, Mini_batch_size = 128, test_img_idx = 1087,
        train_test_split = 0.8, to_shuffle = True, augmentation = False, label_count = [1261, 1416, 1397, 1455, 1463],
        label_normalizer = True, save_augmentation_to_hdf5 = True, learn rate = 0.0001,
        add_bn_inside = True, train_all_layers = False, weights_to_use = None,
        es_patience = 50, train_val_split = 0.9
x_train shape: (5593, 256, 256, 3)
5593 train samples
1399 test samples
block1_conv1
1
block1_conv2
3
block2_conv1
6
block2_conv2
8
block3_conv1
11
block3_conv2
13
block3_conv3
15
block4_conv1
18
block4_conv2
20
block4_conv3
22
block5_conv1
25
block5_conv2
27
block5_conv3
29
<tensorflow.python.keras.engine.input_layer.InputLayer object at 0x7f9673fdff90> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f960791efd0> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f95c411f650> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f96077e8450> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f95c40a5ad0> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f95c4135f10> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f95c4135a50> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f95b01b0590> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f95c413e0d0> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f9563e80ed0> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f95c414e490> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f95c4152110> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f9563d31c90> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f95c4158f90> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f9563ad3b90> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f95c4159d10> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f95512648d0> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f95c4165bd0> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f95c4163c10> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f9551074e50> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f95c40f0f50> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f9550c6ce90> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f95c40f0750> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f95508cdf90> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f95c40f8910> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f95c4100090> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f955081d050> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f95c4106f10> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f955029a550> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f95c410af10> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f94cbe50a10> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f95c4114650> True
<tensorflow.python.keras.layers.core.Flatten object at 0x7f94cbab03d0> True
<tensorflow.python.keras.layers.core.Dense object at 0x7f9550e79fd0> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f94cb8ec090> True
<tensorflow.python.keras.layers.core.Dense object at 0x7f94cb8f2550> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f94cb8f70d0> True
<tensorflow.python.keras.layers.core.Dense object at 0x7f94cb8cbb90> True
Model: "model_13"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 256, 3)]     0         
_________________________________________________________________
block1_conv1 (Conv2D)        (None, 256, 256, 64)      1792      
_________________________________________________________________
batch_normalization (BatchNo (None, 256, 256, 64)      256       
_________________________________________________________________
block1_conv2 (Conv2D)        (None, 256, 256, 64)      36928     
_________________________________________________________________
batch_normalization_1 (Batch (None, 256, 256, 64)      256       
_________________________________________________________________
block1_pool (MaxPooling2D)   (None, 128, 128, 64)      0         
_________________________________________________________________
block2_conv1 (Conv2D)        (None, 128, 128, 128)     73856     
_________________________________________________________________
batch_normalization_2 (Batch (None, 128, 128, 128)     512       
_________________________________________________________________
block2_conv2 (Conv2D)        (None, 128, 128, 128)     147584    
_________________________________________________________________
batch_normalization_3 (Batch (None, 128, 128, 128)     512       
_________________________________________________________________
block2_pool (MaxPooling2D)   (None, 64, 64, 128)       0         
_________________________________________________________________
block3_conv1 (Conv2D)        (None, 64, 64, 256)       295168    
_________________________________________________________________
batch_normalization_4 (Batch (None, 64, 64, 256)       1024      
_________________________________________________________________
block3_conv2 (Conv2D)        (None, 64, 64, 256)       590080    
_________________________________________________________________
batch_normalization_5 (Batch (None, 64, 64, 256)       1024      
_________________________________________________________________
block3_conv3 (Conv2D)        (None, 64, 64, 256)       590080    
_________________________________________________________________
batch_normalization_6 (Batch (None, 64, 64, 256)       1024      
_________________________________________________________________
block3_pool (MaxPooling2D)   (None, 32, 32, 256)       0         
_________________________________________________________________
block4_conv1 (Conv2D)        (None, 32, 32, 512)       1180160   
_________________________________________________________________
batch_normalization_7 (Batch (None, 32, 32, 512)       2048      
_________________________________________________________________
block4_conv2 (Conv2D)        (None, 32, 32, 512)       2359808   
_________________________________________________________________
batch_normalization_8 (Batch (None, 32, 32, 512)       2048      
_________________________________________________________________
block4_conv3 (Conv2D)        (None, 32, 32, 512)       2359808   
_________________________________________________________________
batch_normalization_9 (Batch (None, 32, 32, 512)       2048      
_________________________________________________________________
block4_pool (MaxPooling2D)   (None, 16, 16, 512)       0         
_________________________________________________________________
block5_conv1 (Conv2D)        (None, 16, 16, 512)       2359808   
_________________________________________________________________
batch_normalization_10 (Batc (None, 16, 16, 512)       2048      
_________________________________________________________________
block5_conv2 (Conv2D)        (None, 16, 16, 512)       2359808   
_________________________________________________________________
batch_normalization_11 (Batc (None, 16, 16, 512)       2048      
_________________________________________________________________
block5_conv3 (Conv2D)        (None, 16, 16, 512)       2359808   
_________________________________________________________________
batch_normalization_12 (Batc (None, 16, 16, 512)       2048      
_________________________________________________________________
block5_pool (MaxPooling2D)   (None, 8, 8, 512)         0         
_________________________________________________________________
flatten (Flatten)            (None, 32768)             0         
_________________________________________________________________
fc1 (Dense)                  (None, 4096)              134221824 
_________________________________________________________________
batch_normalization_13 (Batc (None, 4096)              16384     
_________________________________________________________________
fc2 (Dense)                  (None, 4096)              16781312  
_________________________________________________________________
batch_normalization_14 (Batc (None, 4096)              16384     
_________________________________________________________________
predictions (Dense)          (None, 5)                 20485     
=================================================================
Total params: 165,787,973
Trainable params: 165,763,141
Non-trainable params: 24,832
_________________________________________________________________
Start fitting monte carlo batch_normalization model
Train for 79 steps, validate for 9 steps
Epoch 1/150
79/79 - 52s - loss: 2.1596 - accuracy: 0.3783 - val_loss: 1.9107 - val_accuracy: 0.2696
Epoch 2/150
79/79 - 36s - loss: 1.2338 - accuracy: 0.5313 - val_loss: 2.3029 - val_accuracy: 0.2339
Epoch 3/150
79/79 - 36s - loss: 0.8858 - accuracy: 0.6642 - val_loss: 2.3280 - val_accuracy: 0.2286
Epoch 4/150
79/79 - 36s - loss: 0.7293 - accuracy: 0.7312 - val_loss: 2.7775 - val_accuracy: 0.2446
Epoch 5/150
79/79 - 36s - loss: 0.7240 - accuracy: 0.7330 - val_loss: 2.5512 - val_accuracy: 0.2893
Epoch 6/150
79/79 - 36s - loss: 0.6021 - accuracy: 0.7711 - val_loss: 2.3451 - val_accuracy: 0.3464
Epoch 7/150
79/79 - 36s - loss: 0.4492 - accuracy: 0.8359 - val_loss: 2.1310 - val_accuracy: 0.3911
Epoch 8/150
79/79 - 36s - loss: 0.4512 - accuracy: 0.8371 - val_loss: 2.1388 - val_accuracy: 0.4161
Epoch 9/150
79/79 - 36s - loss: 0.3861 - accuracy: 0.8587 - val_loss: 1.7219 - val_accuracy: 0.5304
Epoch 10/150
79/79 - 36s - loss: 0.3020 - accuracy: 0.8947 - val_loss: 1.5147 - val_accuracy: 0.5946
Epoch 11/150
79/79 - 36s - loss: 0.2815 - accuracy: 0.8995 - val_loss: 1.5054 - val_accuracy: 0.5821
Epoch 12/150
79/79 - 36s - loss: 0.2512 - accuracy: 0.9146 - val_loss: 1.3904 - val_accuracy: 0.5911
Epoch 13/150
79/79 - 36s - loss: 0.2232 - accuracy: 0.9207 - val_loss: 1.6099 - val_accuracy: 0.5750
Epoch 14/150
79/79 - 36s - loss: 0.2224 - accuracy: 0.9283 - val_loss: 1.4684 - val_accuracy: 0.6107
Epoch 15/150
79/79 - 36s - loss: 0.1858 - accuracy: 0.9352 - val_loss: 1.5696 - val_accuracy: 0.6286
Epoch 16/150
79/79 - 36s - loss: 0.1772 - accuracy: 0.9410 - val_loss: 1.2889 - val_accuracy: 0.6411
Epoch 17/150
79/79 - 36s - loss: 0.1472 - accuracy: 0.9533 - val_loss: 1.4769 - val_accuracy: 0.5946
Epoch 18/150
79/79 - 36s - loss: 0.1278 - accuracy: 0.9551 - val_loss: 1.9138 - val_accuracy: 0.6018
Epoch 19/150
79/79 - 36s - loss: 0.1947 - accuracy: 0.9378 - val_loss: 1.6925 - val_accuracy: 0.6107
Epoch 20/150
79/79 - 36s - loss: 0.1453 - accuracy: 0.9521 - val_loss: 1.5700 - val_accuracy: 0.6589
Epoch 21/150
79/79 - 36s - loss: 0.1294 - accuracy: 0.9553 - val_loss: 1.6603 - val_accuracy: 0.6161
Epoch 22/150
79/79 - 36s - loss: 0.1680 - accuracy: 0.9446 - val_loss: 1.7743 - val_accuracy: 0.5696
Epoch 23/150
79/79 - 36s - loss: 0.1510 - accuracy: 0.9479 - val_loss: 1.4125 - val_accuracy: 0.6768
Epoch 24/150
79/79 - 36s - loss: 0.1293 - accuracy: 0.9563 - val_loss: 1.5655 - val_accuracy: 0.6536
Epoch 25/150
79/79 - 36s - loss: 0.0811 - accuracy: 0.9724 - val_loss: 1.7166 - val_accuracy: 0.6661
Epoch 26/150
79/79 - 36s - loss: 0.0852 - accuracy: 0.9736 - val_loss: 1.6902 - val_accuracy: 0.6446
Epoch 27/150
79/79 - 36s - loss: 0.0805 - accuracy: 0.9722 - val_loss: 1.6435 - val_accuracy: 0.6571
Epoch 28/150
79/79 - 36s - loss: 0.0636 - accuracy: 0.9811 - val_loss: 1.6577 - val_accuracy: 0.6661
Epoch 29/150
79/79 - 36s - loss: 0.0647 - accuracy: 0.9815 - val_loss: 1.7447 - val_accuracy: 0.6607
Epoch 30/150
79/79 - 36s - loss: 0.0946 - accuracy: 0.9724 - val_loss: 1.7224 - val_accuracy: 0.6411
Epoch 31/150
79/79 - 36s - loss: 0.1056 - accuracy: 0.9664 - val_loss: 1.8426 - val_accuracy: 0.6179
Epoch 32/150
79/79 - 36s - loss: 0.1389 - accuracy: 0.9531 - val_loss: 1.7639 - val_accuracy: 0.6232
Epoch 33/150
79/79 - 36s - loss: 0.1357 - accuracy: 0.9577 - val_loss: 1.6678 - val_accuracy: 0.6339
Epoch 34/150
79/79 - 36s - loss: 0.1246 - accuracy: 0.9605 - val_loss: 1.7179 - val_accuracy: 0.6054
Epoch 35/150
79/79 - 36s - loss: 0.0934 - accuracy: 0.9672 - val_loss: 1.8411 - val_accuracy: 0.6357
Epoch 36/150
79/79 - 36s - loss: 0.0816 - accuracy: 0.9744 - val_loss: 1.7225 - val_accuracy: 0.6750
Epoch 37/150
79/79 - 36s - loss: 0.0407 - accuracy: 0.9889 - val_loss: 1.5947 - val_accuracy: 0.7071
Epoch 38/150
79/79 - 36s - loss: 0.0231 - accuracy: 0.9923 - val_loss: 1.4841 - val_accuracy: 0.6714
Epoch 39/150
79/79 - 36s - loss: 0.0425 - accuracy: 0.9875 - val_loss: 1.5692 - val_accuracy: 0.6839
Epoch 40/150
79/79 - 36s - loss: 0.1348 - accuracy: 0.9583 - val_loss: 1.8679 - val_accuracy: 0.6304
Epoch 41/150
79/79 - 36s - loss: 0.2134 - accuracy: 0.9315 - val_loss: 1.5919 - val_accuracy: 0.6554
Epoch 42/150
79/79 - 36s - loss: 0.1026 - accuracy: 0.9648 - val_loss: 1.7032 - val_accuracy: 0.6411
Epoch 43/150
79/79 - 36s - loss: 0.1008 - accuracy: 0.9684 - val_loss: 1.6171 - val_accuracy: 0.6804
Epoch 44/150
79/79 - 36s - loss: 0.0759 - accuracy: 0.9791 - val_loss: 1.6022 - val_accuracy: 0.6679
Epoch 45/150
79/79 - 36s - loss: 0.0565 - accuracy: 0.9831 - val_loss: 1.6133 - val_accuracy: 0.6911
Epoch 46/150
79/79 - 36s - loss: 0.0410 - accuracy: 0.9881 - val_loss: 1.4557 - val_accuracy: 0.7071
Epoch 47/150
79/79 - 36s - loss: 0.0477 - accuracy: 0.9857 - val_loss: 1.7796 - val_accuracy: 0.6625
Epoch 48/150
79/79 - 36s - loss: 0.0662 - accuracy: 0.9789 - val_loss: 1.6581 - val_accuracy: 0.6696
Epoch 49/150
79/79 - 36s - loss: 0.0226 - accuracy: 0.9928 - val_loss: 1.5743 - val_accuracy: 0.7179
Epoch 50/150
79/79 - 36s - loss: 0.0143 - accuracy: 0.9962 - val_loss: 1.8321 - val_accuracy: 0.6536
Epoch 51/150
79/79 - 36s - loss: 0.0228 - accuracy: 0.9936 - val_loss: 1.6912 - val_accuracy: 0.6804
Epoch 52/150
79/79 - 36s - loss: 0.0277 - accuracy: 0.9924 - val_loss: 1.5370 - val_accuracy: 0.6893
Epoch 53/150
79/79 - 36s - loss: 0.0114 - accuracy: 0.9970 - val_loss: 1.5952 - val_accuracy: 0.6982
Epoch 54/150
79/79 - 36s - loss: 0.0457 - accuracy: 0.9857 - val_loss: 2.2061 - val_accuracy: 0.6393
Epoch 55/150
79/79 - 36s - loss: 0.2786 - accuracy: 0.9179 - val_loss: 1.9273 - val_accuracy: 0.5643
Epoch 56/150
79/79 - 36s - loss: 0.2472 - accuracy: 0.9189 - val_loss: 1.4035 - val_accuracy: 0.6714
Epoch 57/150
79/79 - 36s - loss: 0.0891 - accuracy: 0.9676 - val_loss: 1.7326 - val_accuracy: 0.6518
Epoch 58/150
79/79 - 36s - loss: 0.0794 - accuracy: 0.9734 - val_loss: 1.5329 - val_accuracy: 0.6786
Epoch 59/150
79/79 - 36s - loss: 0.0410 - accuracy: 0.9869 - val_loss: 1.7723 - val_accuracy: 0.6964
Epoch 60/150
79/79 - 36s - loss: 0.0575 - accuracy: 0.9825 - val_loss: 1.6504 - val_accuracy: 0.7036
Epoch 61/150
79/79 - 36s - loss: 0.0503 - accuracy: 0.9869 - val_loss: 1.3813 - val_accuracy: 0.7304
Epoch 62/150
79/79 - 36s - loss: 0.0290 - accuracy: 0.9924 - val_loss: 1.4970 - val_accuracy: 0.7304
Epoch 63/150
79/79 - 36s - loss: 0.0208 - accuracy: 0.9942 - val_loss: 1.5744 - val_accuracy: 0.7268
Epoch 64/150
79/79 - 36s - loss: 0.0171 - accuracy: 0.9944 - val_loss: 1.4269 - val_accuracy: 0.7411
Epoch 65/150
79/79 - 36s - loss: 0.0207 - accuracy: 0.9948 - val_loss: 1.6995 - val_accuracy: 0.7089
Epoch 66/150
79/79 - 36s - loss: 0.0355 - accuracy: 0.9891 - val_loss: 1.7869 - val_accuracy: 0.7000
Epoch 00066: early stopping
  0/250 [..............................] - ETA: 0s2020-03-12 19:09:16.495778: W tensorflow/core/kernels/gpu_utils.cc:48] Failed to allocate memory for convolution redzone checking; skipping this check. This is benign and only means that we won't check cudnn for out-of-bounds reads and writes. This message will only be printed once.
2020-03-12 19:09:16.500180: F tensorflow/stream_executor/cuda/cuda_dnn.cc:516] Check failed: cudnnSetTensorNdDescriptor(handle_.get(), elem_type, nd, dims.data(), strides.data()) == CUDNN_STATUS_SUCCESS (9 vs. 0)batch_descriptor: {count: 1399 feature_map_count: 64 spatial: 256 256  value_min: 0.000000 value_max: 0.000000 layout: BatchDepthYX}
[pg-gpu34:23004] *** Process received signal ***
[pg-gpu34:23004] Signal: Aborted (6)
[pg-gpu34:23004] Signal code:  (-6)
[pg-gpu34:23004] [ 0] /lib64/libpthread.so.0(+0xf5f0)[0x7f967b6bd5f0]
[pg-gpu34:23004] [ 1] /lib64/libc.so.6(gsignal+0x37)[0x7f967b113337]
[pg-gpu34:23004] [ 2] /lib64/libc.so.6(abort+0x148)[0x7f967b114a28]
[pg-gpu34:23004] [ 3] /software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so(+0xb10a737)[0x7f963a234737]
[pg-gpu34:23004] [ 4] /software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/../libtensorflow_framework.so.2(+0xb698cb)[0x7f962d2d28cb]
[pg-gpu34:23004] [ 5] /software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/../libtensorflow_framework.so.2(_ZN15stream_executor3gpu12CudnnSupport19DoFusedConvolveImplIffffEEN10tensorflow6StatusEPNS_6StreamERKNS_3dnn15BatchDescriptorERKNS_12DeviceMemoryIT_EET1_RKNS7_16FilterDescriptorESF_RKNS7_21ConvolutionDescriptorERKNSB_IT2_EESG_SA_RKNSB_IT0_EENS7_14ActivationModeESA_PSO_NS7_8DataTypeEPNS_16ScratchAllocatorERKNS7_15AlgorithmConfigEPNS7_13ProfileResultE+0x130)[0x7f962e8f0960]
[pg-gpu34:23004] [ 6] /software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/../libtensorflow_framework.so.2(_ZN15stream_executor3gpu12CudnnSupport15DoFusedConvolveEPNS_6StreamERKNS_3dnn15BatchDescriptorERKNS_12DeviceMemoryIfEEfRKNS4_16FilterDescriptorESB_RKNS4_21ConvolutionDescriptorESB_fS7_SB_NS4_14ActivationModeES7_PS9_PNS_16ScratchAllocatorERKNS4_15AlgorithmConfigEPNS4_13ProfileResultE+0x4c)[0x7f962e8f151c]
[pg-gpu34:23004] [ 7] /software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so(_ZN15stream_executor6Stream30ThenFusedConvolveWithAlgorithmERKNS_3dnn15BatchDescriptorERKNS_12DeviceMemoryIfEEfRKNS1_16FilterDescriptorES8_RKNS1_21ConvolutionDescriptorES8_fS4_S8_NS1_14ActivationModeES4_PS6_PNS_16ScratchAllocatorERKNS1_15AlgorithmConfigEPNS1_13ProfileResultE+0xd81)[0x7f9639076961]
[pg-gpu34:23004] [ 8] /software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so(_ZN10tensorflow25FindBestConvolveAlgorithmIfZNS_19LaunchFusedConv2DOpIN5Eigen9GpuDeviceEfEclEPNS_15OpKernelContextEbbRKNS_6TensorES9_NS_20FusedComputationTypeERKNS_20FusedComputationArgsERKNS_16Conv2DParametersERKNS_16Conv2DDimensionsEPS7_EUlN15stream_executor3dnn15AlgorithmConfigEPNSL_16ScratchAllocatorENSL_12DeviceMemoryIfEEPNSM_13ProfileResultEE0_ZNS4_clES6_bbS9_S9_SA_SD_SG_SJ_SK_EUlN4absl4SpanIKNS_14AutotuneResultEEEE1_EENS_6StatusERKNS_19FusedConvParametersET0_S6_PNSL_6StreamENSQ_IT_EERKT1_PSN_+0x670)[0x7f9637c66510]
[pg-gpu34:23004] [ 9] /software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so(_ZN10tensorflow19LaunchFusedConv2DOpIN5Eigen9GpuDeviceEfEclEPNS_15OpKernelContextEbbRKNS_6TensorES8_NS_20FusedComputationTypeERKNS_20FusedComputationArgsERKNS_16Conv2DParametersERKNS_16Conv2DDimensionsEPS6_+0xfec)[0x7f9637c67c5c]
[pg-gpu34:23004] [10] /software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so(_ZN10tensorflow13FusedConv2DOpIN5Eigen9GpuDeviceEfE7ComputeEPNS_15OpKernelContextE+0x1af)[0x7f9637c6894f]
[pg-gpu34:23004] [11] /software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/../libtensorflow_framework.so.2(_ZN10tensorflow13BaseGPUDevice7ComputeEPNS_8OpKernelEPNS_15OpKernelContextE+0xdb)[0x7f962da5407b]
[pg-gpu34:23004] [12] /software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/../libtensorflow_framework.so.2(+0x134a0a9)[0x7f962dab30a9]
[pg-gpu34:23004] [13] /software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/../libtensorflow_framework.so.2(+0x134a7cf)[0x7f962dab37cf]
[pg-gpu34:23004] [14] /software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/../libtensorflow_framework.so.2(_ZN5Eigen15ThreadPoolTemplIN10tensorflow6thread16EigenEnvironmentEE10WorkerLoopEi+0x48b)[0x7f962e475f8b]
[pg-gpu34:23004] [15] /software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/../libtensorflow_framework.so.2(_ZNSt17_Function_handlerIFvvEZN10tensorflow6thread16EigenEnvironment12CreateThreadESt8functionIS0_EEUlvE_E9_M_invokeERKSt9_Any_data+0x43)[0x7f962e473763]
[pg-gpu34:23004] [16] /software/software/GCCcore/8.3.0/lib64/libstdc++.so.6(+0xcf0df)[0x7f96686330df]
[pg-gpu34:23004] [17] /lib64/libpthread.so.0(+0x7e65)[0x7f967b6b5e65]
[pg-gpu34:23004] [18] /lib64/libc.so.6(clone+0x6d)[0x7f967b1db88d]
[pg-gpu34:23004] *** End of error message ***
/var/spool/slurmd/job10068447/slurm_script: line 14: 23004 Aborted                 python MCBN_mes.py


###############################################################################
Peregrine Cluster
Job 10068447 for user 's2934833'
Finished at: Thu Mar 12 19:09:21 CET 2020

Job details:
============

Name                : MCBNMessidor2
User                : s2934833
Partition           : gpu
Nodes               : pg-gpu34
Cores               : 12
State               : FAILED
Submit              : 2020-03-12T17:25:39
Start               : 2020-03-12T18:28:38
End                 : 2020-03-12T19:09:17
Reserved walltime   : 02:00:00
Used walltime       : 00:40:39
Used CPU time       : 00:32:45 (efficiency:  6.71%)
% User (Computation): 67.61%
% System (I/O)      : 32.39%
Mem reserved        : 62.50G/node
Max Mem used        : 9.40G (pg-gpu34)
Max Disk Write      : 153.60K (pg-gpu34)
Max Disk Read       : 5.35M (pg-gpu34)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/additional_information/scientific_output

################################################################################
