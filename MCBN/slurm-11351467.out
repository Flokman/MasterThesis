
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompic-2019b => FFTW/3.3.8-gompi-2019b
  2) OpenMPI/3.1.4-gcccuda-2019b => OpenMPI/3.1.4-GCC-8.3.0
  3) ScaLAPACK/2.0.2-gompic-2019b => ScaLAPACK/2.0.2-gompi-2019b
  4) SciPy-bundle/2019.10-fosscuda-2019b-Python-3.7.4 => SciPy-bundle/2019.10-foss-2019b-Python-3.7.4

2020-05-10 12:14:44.107284: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-10 12:14:54.747820: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-05-10 12:14:54.756754: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:14:54.757752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GRID V100D-32Q computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 31.88GiB deviceMemoryBandwidth: 836.37GiB/s
2020-05-10 12:14:54.757848: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-10 12:14:54.764478: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-10 12:14:54.769289: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-10 12:14:54.771554: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-10 12:14:54.776095: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-10 12:14:54.779129: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-10 12:14:54.786290: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-10 12:14:54.786577: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:14:54.787464: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:14:54.787904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-05-10 12:14:54.791526: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:14:54.792083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GRID V100D-32Q computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 31.88GiB deviceMemoryBandwidth: 836.37GiB/s
2020-05-10 12:14:54.792171: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-10 12:14:54.792245: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-10 12:14:54.792309: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-10 12:14:54.792370: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-10 12:14:54.792431: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-10 12:14:54.792492: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-10 12:14:54.792553: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-10 12:14:54.792723: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:14:54.793367: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:14:54.793808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-05-10 12:14:54.793901: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-10 12:14:55.529825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1096] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-05-10 12:14:55.530004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102]      0 
2020-05-10 12:14:55.530061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] 0:   N 
2020-05-10 12:14:55.530503: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:14:55.531266: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:14:55.531857: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 12:14:55.532340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1241] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 28652 MB memory) -> physical GPU (device: 0, name: GRID V100D-32Q, pci bus id: 0000:02:00.0, compute capability: 7.0)
2020-05-10 12:14:55.532768: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 12. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
2020-05-10 12:15:07.455059: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-10 12:15:07.764010: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-10 12:15:11.902886: I tensorflow/core/profiler/lib/profiler_session.cc:225] Profiler session started.
2020-05-10 12:15:11.903114: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1259] Profiler found 1 GPUs
2020-05-10 12:15:11.906515: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcupti.so.10.1
2020-05-10 12:15:12.007835: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1307] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_VIRTUALIZED_DEVICE_NOT_SUPPORTED
2020-05-10 12:15:12.008618: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1346] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI_ERROR_VIRTUALIZED_DEVICE_NOT_SUPPORTED
2020-05-10 12:15:12.236057: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1329] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI_ERROR_INVALID_PARAMETER
2020-05-10 12:15:12.236264: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:88]  GpuTracer has collected 0 callback api events and 0 activity events.
dataset_name = /Messidor2_PNG_256.hdf5, batch_size = 32, num_classes = 5, epochs = 150,
        MCBN_PREDICTIONS = 25, Mini_batch_size = 128, test_img_idx = 186,
        train_test_split = 0.8, to_shuffle = False, augmentation = False, label_count = [1021, 270, 347, 75, 35],
        label_normalizer = False, save_augmentation_to_hdf5 = False, learn rate = 0.001,
        add_bn_inside = True, train_all_layers = True, weights_to_use = imagenet,
        es_patience = 20, train_val_split = 0.9, MIN_DELTA = 0.005, Early_monitor = val_accuracy
x_train shape: (1398, 256, 256, 3)
1398 train samples
350 test samples
block1_conv1
1
block1_conv2
3
block2_conv1
6
block2_conv2
8
block3_conv1
11
block3_conv2
13
block3_conv3
15
block4_conv1
18
block4_conv2
20
block4_conv3
22
block5_conv1
25
block5_conv2
27
block5_conv3
29
<tensorflow.python.keras.engine.input_layer.InputLayer object at 0x7f54ee658450> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f54ed4f7d50> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f54d9169f10> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f54ed376590> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f54d9171b50> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f54ecb2afd0> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f54ec02c450> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f54d8f7b890> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f54ec038a90> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f54d8e49fd0> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f54ec047650> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f54ec04ad50> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f54d8c7a490> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f54ec04a510> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f54c01b9e90> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f54d9188f10> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f547866c3d0> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f54d91a0850> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f54d91a6110> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f547841cb10> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f54d91ace10> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f5478152890> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f54d91b5f50> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f54c026fe10> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f54d91c0b50> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f54d91c4c10> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f547024bb10> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f54d9152f90> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f5470116850> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f54d9152850> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f5434151f10> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f54d9166910> True
<tensorflow.python.keras.layers.core.Flatten object at 0x7f5411d229d0> True
<tensorflow.python.keras.layers.core.Dense object at 0x7f5434069710> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f5411c4cd90> True
<tensorflow.python.keras.layers.core.Dense object at 0x7f5411c4cf10> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7f5411c25950> True
<tensorflow.python.keras.layers.core.Dense object at 0x7f5411c37bd0> True
Model: "model_13"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 256, 3)]     0         
_________________________________________________________________
block1_conv1 (Conv2D)        (None, 256, 256, 64)      1792      
_________________________________________________________________
batch_normalization (BatchNo (None, 256, 256, 64)      256       
_________________________________________________________________
block1_conv2 (Conv2D)        (None, 256, 256, 64)      36928     
_________________________________________________________________
batch_normalization_1 (Batch (None, 256, 256, 64)      256       
_________________________________________________________________
block1_pool (MaxPooling2D)   (None, 128, 128, 64)      0         
_________________________________________________________________
block2_conv1 (Conv2D)        (None, 128, 128, 128)     73856     
_________________________________________________________________
batch_normalization_2 (Batch (None, 128, 128, 128)     512       
_________________________________________________________________
block2_conv2 (Conv2D)        (None, 128, 128, 128)     147584    
_________________________________________________________________
batch_normalization_3 (Batch (None, 128, 128, 128)     512       
_________________________________________________________________
block2_pool (MaxPooling2D)   (None, 64, 64, 128)       0         
_________________________________________________________________
block3_conv1 (Conv2D)        (None, 64, 64, 256)       295168    
_________________________________________________________________
batch_normalization_4 (Batch (None, 64, 64, 256)       1024      
_________________________________________________________________
block3_conv2 (Conv2D)        (None, 64, 64, 256)       590080    
_________________________________________________________________
batch_normalization_5 (Batch (None, 64, 64, 256)       1024      
_________________________________________________________________
block3_conv3 (Conv2D)        (None, 64, 64, 256)       590080    
_________________________________________________________________
batch_normalization_6 (Batch (None, 64, 64, 256)       1024      
_________________________________________________________________
block3_pool (MaxPooling2D)   (None, 32, 32, 256)       0         
_________________________________________________________________
block4_conv1 (Conv2D)        (None, 32, 32, 512)       1180160   
_________________________________________________________________
batch_normalization_7 (Batch (None, 32, 32, 512)       2048      
_________________________________________________________________
block4_conv2 (Conv2D)        (None, 32, 32, 512)       2359808   
_________________________________________________________________
batch_normalization_8 (Batch (None, 32, 32, 512)       2048      
_________________________________________________________________
block4_conv3 (Conv2D)        (None, 32, 32, 512)       2359808   
_________________________________________________________________
batch_normalization_9 (Batch (None, 32, 32, 512)       2048      
_________________________________________________________________
block4_pool (MaxPooling2D)   (None, 16, 16, 512)       0         
_________________________________________________________________
block5_conv1 (Conv2D)        (None, 16, 16, 512)       2359808   
_________________________________________________________________
batch_normalization_10 (Batc (None, 16, 16, 512)       2048      
_________________________________________________________________
block5_conv2 (Conv2D)        (None, 16, 16, 512)       2359808   
_________________________________________________________________
batch_normalization_11 (Batc (None, 16, 16, 512)       2048      
_________________________________________________________________
block5_conv3 (Conv2D)        (None, 16, 16, 512)       2359808   
_________________________________________________________________
batch_normalization_12 (Batc (None, 16, 16, 512)       2048      
_________________________________________________________________
block5_pool (MaxPooling2D)   (None, 8, 8, 512)         0         
_________________________________________________________________
flatten (Flatten)            (None, 32768)             0         
_________________________________________________________________
fc1 (Dense)                  (None, 4096)              134221824 
_________________________________________________________________
batch_normalization_13 (Batc (None, 4096)              16384     
_________________________________________________________________
fc2 (Dense)                  (None, 4096)              16781312  
_________________________________________________________________
batch_normalization_14 (Batc (None, 4096)              16384     
_________________________________________________________________
predictions (Dense)          (None, 5)                 20485     
=================================================================
Total params: 165,787,973
Trainable params: 165,763,141
Non-trainable params: 24,832
_________________________________________________________________
Start fitting monte carlo batch_normalization model
Train for 40 steps, validate for 5 steps
Epoch 1/150
40/40 - 24s - loss: 2.3140 - accuracy: 0.3514 - val_loss: 2.0948 - val_accuracy: 0.2714
Epoch 2/150
40/40 - 9s - loss: 1.6633 - accuracy: 0.4650 - val_loss: 2.1386 - val_accuracy: 0.4214
Epoch 3/150
40/40 - 9s - loss: 1.4176 - accuracy: 0.5111 - val_loss: 2.3114 - val_accuracy: 0.4357
Epoch 4/150
40/40 - 9s - loss: 1.2422 - accuracy: 0.5612 - val_loss: 2.1350 - val_accuracy: 0.4286
Epoch 5/150
40/40 - 9s - loss: 1.2609 - accuracy: 0.5620 - val_loss: 2.1513 - val_accuracy: 0.5071
Epoch 6/150
40/40 - 9s - loss: 1.1938 - accuracy: 0.5970 - val_loss: 2.6598 - val_accuracy: 0.4929
Epoch 7/150
40/40 - 12s - loss: 1.0074 - accuracy: 0.6343 - val_loss: 1.6445 - val_accuracy: 0.4786
Epoch 8/150
40/40 - 14s - loss: 0.8664 - accuracy: 0.6971 - val_loss: 1.6083 - val_accuracy: 0.4786
Epoch 9/150
40/40 - 13s - loss: 0.8882 - accuracy: 0.6987 - val_loss: 1.4519 - val_accuracy: 0.5143
Epoch 10/150
40/40 - 12s - loss: 0.7133 - accuracy: 0.7560 - val_loss: 1.1940 - val_accuracy: 0.5929
Epoch 11/150
40/40 - 9s - loss: 0.4817 - accuracy: 0.8378 - val_loss: 1.5567 - val_accuracy: 0.5571
Epoch 12/150
40/40 - 9s - loss: 0.3997 - accuracy: 0.8585 - val_loss: 1.4584 - val_accuracy: 0.5714
Epoch 13/150
40/40 - 9s - loss: 0.3577 - accuracy: 0.8760 - val_loss: 2.0120 - val_accuracy: 0.6071
Epoch 14/150
40/40 - 9s - loss: 0.3569 - accuracy: 0.8712 - val_loss: 1.6148 - val_accuracy: 0.5714
Epoch 15/150
40/40 - 9s - loss: 0.4464 - accuracy: 0.8585 - val_loss: 1.7382 - val_accuracy: 0.5857
Epoch 16/150
40/40 - 9s - loss: 0.2307 - accuracy: 0.9221 - val_loss: 1.9396 - val_accuracy: 0.6000
Epoch 17/150
40/40 - 9s - loss: 0.1480 - accuracy: 0.9579 - val_loss: 2.1869 - val_accuracy: 0.5857
Epoch 18/150
40/40 - 9s - loss: 0.1247 - accuracy: 0.9610 - val_loss: 2.4155 - val_accuracy: 0.5571
Epoch 19/150
40/40 - 9s - loss: 0.1221 - accuracy: 0.9618 - val_loss: 2.6916 - val_accuracy: 0.5786
Epoch 20/150
40/40 - 9s - loss: 0.0706 - accuracy: 0.9762 - val_loss: 2.2022 - val_accuracy: 0.6214
Epoch 21/150
40/40 - 9s - loss: 0.0685 - accuracy: 0.9769 - val_loss: 2.5638 - val_accuracy: 0.6214
Epoch 22/150
40/40 - 9s - loss: 0.0458 - accuracy: 0.9889 - val_loss: 2.3982 - val_accuracy: 0.6357
Epoch 23/150
40/40 - 9s - loss: 0.0329 - accuracy: 0.9905 - val_loss: 2.6478 - val_accuracy: 0.6000
Epoch 24/150
40/40 - 9s - loss: 0.0543 - accuracy: 0.9865 - val_loss: 2.8837 - val_accuracy: 0.6286
Epoch 25/150
40/40 - 9s - loss: 0.0475 - accuracy: 0.9849 - val_loss: 2.3736 - val_accuracy: 0.6000
Epoch 26/150
40/40 - 9s - loss: 0.0398 - accuracy: 0.9881 - val_loss: 3.3345 - val_accuracy: 0.5643
Epoch 27/150
40/40 - 9s - loss: 0.0345 - accuracy: 0.9897 - val_loss: 2.5191 - val_accuracy: 0.5929
Epoch 28/150
40/40 - 9s - loss: 0.0482 - accuracy: 0.9881 - val_loss: 2.5684 - val_accuracy: 0.6214
Epoch 29/150
40/40 - 9s - loss: 0.0156 - accuracy: 0.9952 - val_loss: 2.5483 - val_accuracy: 0.6286
Epoch 30/150
40/40 - 9s - loss: 0.0078 - accuracy: 0.9992 - val_loss: 2.4963 - val_accuracy: 0.6286
Epoch 31/150
40/40 - 9s - loss: 0.0048 - accuracy: 0.9984 - val_loss: 2.6643 - val_accuracy: 0.6357
Epoch 32/150
40/40 - 9s - loss: 0.0061 - accuracy: 0.9976 - val_loss: 2.5161 - val_accuracy: 0.6286
Epoch 33/150
40/40 - 9s - loss: 0.0052 - accuracy: 0.9992 - val_loss: 2.6402 - val_accuracy: 0.6286
Epoch 34/150
40/40 - 9s - loss: 0.0014 - accuracy: 1.0000 - val_loss: 2.6476 - val_accuracy: 0.6214
Epoch 35/150
40/40 - 9s - loss: 0.0010 - accuracy: 1.0000 - val_loss: 2.6928 - val_accuracy: 0.6143
Epoch 36/150
40/40 - 9s - loss: 9.4214e-04 - accuracy: 1.0000 - val_loss: 2.7284 - val_accuracy: 0.6143
Epoch 37/150
40/40 - 9s - loss: 8.6177e-04 - accuracy: 1.0000 - val_loss: 2.7492 - val_accuracy: 0.6143
Epoch 38/150
40/40 - 9s - loss: 7.9622e-04 - accuracy: 1.0000 - val_loss: 2.7786 - val_accuracy: 0.6143
Epoch 39/150
40/40 - 9s - loss: 7.4455e-04 - accuracy: 1.0000 - val_loss: 2.7965 - val_accuracy: 0.6143
Epoch 40/150
40/40 - 9s - loss: 7.0022e-04 - accuracy: 1.0000 - val_loss: 2.8178 - val_accuracy: 0.6071
Epoch 41/150
40/40 - 9s - loss: 6.5860e-04 - accuracy: 1.0000 - val_loss: 2.8355 - val_accuracy: 0.6071
Epoch 42/150
40/40 - 9s - loss: 6.2653e-04 - accuracy: 1.0000 - val_loss: 2.8511 - val_accuracy: 0.6071
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
2020-05-10 12:22:04.368408: W tensorflow/core/kernels/gpu_utils.cc:48] Failed to allocate memory for convolution redzone checking; skipping this check. This is benign and only means that we won't check cudnn for out-of-bounds reads and writes. This message will only be printed once.
Epoch 00042: early stopping
Done fitting
input_1 False
block1_conv1 False
batch_normalization True
block1_conv2 False
batch_normalization_1 True
block1_pool False
block2_conv1 False
batch_normalization_2 True
block2_conv2 False
batch_normalization_3 True
block2_pool False
block3_conv1 False
batch_normalization_4 True
block3_conv2 False
batch_normalization_5 True
block3_conv3 False
batch_normalization_6 True
block3_pool False
block4_conv1 False
batch_normalization_7 True
block4_conv2 False
batch_normalization_8 True
block4_conv3 False
batch_normalization_9 True
block4_pool False
block5_conv1 False
batch_normalization_10 True
block5_conv2 False
batch_normalization_11 True
block5_conv3 False
batch_normalization_12 True
block5_pool False
flatten False
fc1 False
batch_normalization_13 True
fc2 False
batch_normalization_14 True
predictions False
1/1 [==============================] - 8s 8s/step - loss: 1.2397 - accuracy: 0.6143
[1.2397470474243164, 0.6142857]
input_1 False
block1_conv1 False
batch_normalization False
block1_conv2 False
batch_normalization_1 False
block1_pool False
block2_conv1 False
batch_normalization_2 False
block2_conv2 False
batch_normalization_3 False
block2_pool False
block3_conv1 False
batch_normalization_4 False
block3_conv2 False
batch_normalization_5 False
block3_conv3 False
batch_normalization_6 False
block3_pool False
block4_conv1 False
batch_normalization_7 False
block4_conv2 False
batch_normalization_8 False
block4_conv3 False
batch_normalization_9 False
block4_pool False
block5_conv1 False
batch_normalization_10 False
block5_conv2 False
batch_normalization_11 False
block5_conv3 False
batch_normalization_12 False
block5_pool False
flatten False
fc1 False
batch_normalization_13 False
fc2 False
batch_normalization_14 False
predictions False
 0/25 [..............................] - ETA: 0sWARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
 1/25 [>.............................] - ETA: 4:45WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
 4/25 [===>..........................] - ETA: 1:36WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
 7/25 [=======>......................] - ETA: 1:03WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
10/25 [===========>..................] - ETA: 46s WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
13/25 [==============>...............] - ETA: 34sWARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
16/25 [==================>...........] - ETA: 24sWARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
19/25 [=====================>........] - ETA: 15sWARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
22/25 [=========================>....] - ETA: 7s WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
MCBN accuracy: 45.9%
MCBN-ensemble accuracy: 59.4%
tf.Tensor(
[[208   0   0   0   0]
 [ 51   0   0   0   0]
 [ 68   0   0   0   0]
 [ 16   0   0   0   0]
 [  7   0   0   0   0]], shape=(5, 5), dtype=int32)
posterior mean: 0
true label: 2

class: 0; proba: 59.2%; var: 29.05% 
class: 1; proba: 15.9%; var: 17.05% 
class: 2; proba: 16.9%; var: 23.83% 
class: 3; proba: 4.7%; var: 6.43% 
class: 4; proba: 3.2%; var: 3.20% 


###############################################################################
Peregrine Cluster
Job 11351467 for user 's2934833'
Finished at: Sun May 10 12:23:18 CEST 2020

Job details:
============

Name                : MESBN
User                : s2934833
Partition           : gpu
Nodes               : pg-gpu25
Cores               : 12
State               : COMPLETED
Submit              : 2020-05-10T11:57:32
Start               : 2020-05-10T12:14:35
End                 : 2020-05-10T12:23:18
Reserved walltime   : 02:00:00
Used walltime       : 00:08:43
Used CPU time       : 00:07:10 (efficiency:  6.86%)
% User (Computation): 69.85%
% System (I/O)      : 30.15%
Mem reserved        : 62.50G/node
Max Mem used        : 12.73G (pg-gpu25)
Max Disk Write      : 153.60K (pg-gpu25)
Max Disk Read       : 5.83M (pg-gpu25)
Average GPU usage   : 64.6% (pg-gpu25)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/additional_information/scientific_output

################################################################################
