
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompic-2019b => FFTW/3.3.8-gompi-2019b
  2) OpenMPI/3.1.4-gcccuda-2019b => OpenMPI/3.1.4-GCC-8.3.0
  3) ScaLAPACK/2.0.2-gompic-2019b => ScaLAPACK/2.0.2-gompi-2019b
  4) SciPy-bundle/2019.10-fosscuda-2019b-Python-3.7.4 => SciPy-bundle/2019.10-foss-2019b-Python-3.7.4

2020-03-14 11:34:27.331764: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-03-14 11:34:34.103970: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-03-14 11:34:34.110854: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-14 11:34:34.111307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GRID V100D-32Q computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 31.87GiB deviceMemoryBandwidth: 836.37GiB/s
2020-03-14 11:34:34.111349: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-03-14 11:34:34.115909: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-03-14 11:34:34.119219: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-03-14 11:34:34.120630: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-03-14 11:34:34.123978: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-03-14 11:34:34.125870: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-03-14 11:34:34.131019: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-03-14 11:34:34.131181: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-14 11:34:34.131818: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-14 11:34:34.132227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-03-14 11:34:34.134618: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-14 11:34:34.135048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GRID V100D-32Q computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 31.87GiB deviceMemoryBandwidth: 836.37GiB/s
2020-03-14 11:34:34.135091: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-03-14 11:34:34.135127: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-03-14 11:34:34.135149: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-03-14 11:34:34.135170: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-03-14 11:34:34.135191: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-03-14 11:34:34.135212: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-03-14 11:34:34.135232: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-03-14 11:34:34.135332: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-14 11:34:34.135841: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-14 11:34:34.136234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-03-14 11:34:34.136283: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-03-14 11:34:34.872035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1096] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-03-14 11:34:34.872119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102]      0 
2020-03-14 11:34:34.872133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] 0:   N 
2020-03-14 11:34:34.872395: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-14 11:34:34.873051: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-14 11:34:34.873663: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-03-14 11:34:34.874072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1241] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 28652 MB memory) -> physical GPU (device: 0, name: GRID V100D-32Q, pci bus id: 0000:02:00.0, compute capability: 7.0)
2020-03-14 11:34:34.874652: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
2020-03-14 11:34:46.293461: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-03-14 11:34:46.599031: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-03-14 11:34:48.644292: I tensorflow/core/profiler/lib/profiler_session.cc:225] Profiler session started.
2020-03-14 11:34:48.644399: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1259] Profiler found 1 GPUs
2020-03-14 11:34:48.646792: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcupti.so.10.1
2020-03-14 11:34:48.747328: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1307] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_VIRTUALIZED_DEVICE_NOT_SUPPORTED
2020-03-14 11:34:48.747798: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1346] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI_ERROR_VIRTUALIZED_DEVICE_NOT_SUPPORTED
2020-03-14 11:34:48.766387: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1329] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI_ERROR_INVALID_PARAMETER
2020-03-14 11:34:48.766432: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:88]  GpuTracer has collected 0 callback api events and 0 activity events.
dataset_name = CIFAR10, batch_size = 32, num_classes = 10, epochs = 150,
        MCBN_PREDICTIONS = 250, Mini_batch_size = 128, test_img_idx = 227,
        train_test_split = 0.8, to_shuffle = True, augmentation = False,
        label_normalizer = True, save_augmentation_to_hdf5 = True, learn rate = 0.0001,
        add_bn_inside = True, train_all_layers = False, weights_to_use = imagenet,
        es_patience = 50, train_val_split = 0.9
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 test samples
block1_conv1
1
block1_conv2
3
block2_conv1
6
block2_conv2
8
block3_conv1
11
block3_conv2
13
block3_conv3
15
block4_conv1
18
block4_conv2
20
block4_conv3
22
block5_conv1
25
block5_conv2
27
block5_conv3
29
<tensorflow.python.keras.engine.input_layer.InputLayer object at 0x7fd61667e990> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7fd614026fd0> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd608047690> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7fd614026b50> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd5f00aafd0> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7fd6080a4490> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7fd6080b1950> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd5a871b250> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7fd60a591c90> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd5a8591810> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7fd6080cd2d0> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7fd6080dd090> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd5a83d1ed0> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7fd608062e10> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd5a81e8410> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7fd60806be50> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd56a7327d0> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7fd608077b90> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7fd60807db90> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd56a4d1f90> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7fd608088f50> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd5a8092e90> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7fd608088690> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd569e09a50> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7fd608097950> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7fd6080240d0> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd569d240d0> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7fd608028e10> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd5698045d0> True
<tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7fd608030f50> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd56933b910> True
<tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7fd60803c3d0> True
<tensorflow.python.keras.layers.core.Flatten object at 0x7fd568e4ee90> True
<tensorflow.python.keras.layers.core.Dense object at 0x7fd568e22f90> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd568d4af90> True
<tensorflow.python.keras.layers.core.Dense object at 0x7fd568d56290> True
<tensorflow.python.keras.layers.normalization_v2.BatchNormalization object at 0x7fd568d603d0> True
<tensorflow.python.keras.layers.core.Dense object at 0x7fd568d36d10> True
Model: "model_13"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 32, 32, 3)]       0         
_________________________________________________________________
block1_conv1 (Conv2D)        (None, 32, 32, 64)        1792      
_________________________________________________________________
batch_normalization (BatchNo (None, 32, 32, 64)        256       
_________________________________________________________________
block1_conv2 (Conv2D)        (None, 32, 32, 64)        36928     
_________________________________________________________________
batch_normalization_1 (Batch (None, 32, 32, 64)        256       
_________________________________________________________________
block1_pool (MaxPooling2D)   (None, 16, 16, 64)        0         
_________________________________________________________________
block2_conv1 (Conv2D)        (None, 16, 16, 128)       73856     
_________________________________________________________________
batch_normalization_2 (Batch (None, 16, 16, 128)       512       
_________________________________________________________________
block2_conv2 (Conv2D)        (None, 16, 16, 128)       147584    
_________________________________________________________________
batch_normalization_3 (Batch (None, 16, 16, 128)       512       
_________________________________________________________________
block2_pool (MaxPooling2D)   (None, 8, 8, 128)         0         
_________________________________________________________________
block3_conv1 (Conv2D)        (None, 8, 8, 256)         295168    
_________________________________________________________________
batch_normalization_4 (Batch (None, 8, 8, 256)         1024      
_________________________________________________________________
block3_conv2 (Conv2D)        (None, 8, 8, 256)         590080    
_________________________________________________________________
batch_normalization_5 (Batch (None, 8, 8, 256)         1024      
_________________________________________________________________
block3_conv3 (Conv2D)        (None, 8, 8, 256)         590080    
_________________________________________________________________
batch_normalization_6 (Batch (None, 8, 8, 256)         1024      
_________________________________________________________________
block3_pool (MaxPooling2D)   (None, 4, 4, 256)         0         
_________________________________________________________________
block4_conv1 (Conv2D)        (None, 4, 4, 512)         1180160   
_________________________________________________________________
batch_normalization_7 (Batch (None, 4, 4, 512)         2048      
_________________________________________________________________
block4_conv2 (Conv2D)        (None, 4, 4, 512)         2359808   
_________________________________________________________________
batch_normalization_8 (Batch (None, 4, 4, 512)         2048      
_________________________________________________________________
block4_conv3 (Conv2D)        (None, 4, 4, 512)         2359808   
_________________________________________________________________
batch_normalization_9 (Batch (None, 4, 4, 512)         2048      
_________________________________________________________________
block4_pool (MaxPooling2D)   (None, 2, 2, 512)         0         
_________________________________________________________________
block5_conv1 (Conv2D)        (None, 2, 2, 512)         2359808   
_________________________________________________________________
batch_normalization_10 (Batc (None, 2, 2, 512)         2048      
_________________________________________________________________
block5_conv2 (Conv2D)        (None, 2, 2, 512)         2359808   
_________________________________________________________________
batch_normalization_11 (Batc (None, 2, 2, 512)         2048      
_________________________________________________________________
block5_conv3 (Conv2D)        (None, 2, 2, 512)         2359808   
_________________________________________________________________
batch_normalization_12 (Batc (None, 2, 2, 512)         2048      
_________________________________________________________________
block5_pool (MaxPooling2D)   (None, 1, 1, 512)         0         
_________________________________________________________________
flatten (Flatten)            (None, 512)               0         
_________________________________________________________________
fc1 (Dense)                  (None, 4096)              2101248   
_________________________________________________________________
batch_normalization_13 (Batc (None, 4096)              16384     
_________________________________________________________________
fc2 (Dense)                  (None, 4096)              16781312  
_________________________________________________________________
batch_normalization_14 (Batc (None, 4096)              16384     
_________________________________________________________________
predictions (Dense)          (None, 10)                40970     
=================================================================
Total params: 33,687,882
Trainable params: 33,663,050
Non-trainable params: 24,832
_________________________________________________________________
Start fitting monte carlo batch_normalization model
Train for 1407 steps, validate for 157 steps
Epoch 1/150
1407/1407 - 30s - loss: 1.1555 - accuracy: 0.6632 - val_loss: 0.6591 - val_accuracy: 0.7804
Epoch 2/150
1407/1407 - 23s - loss: 0.6112 - accuracy: 0.7985 - val_loss: 0.5921 - val_accuracy: 0.7994
Epoch 3/150
1407/1407 - 23s - loss: 0.4456 - accuracy: 0.8535 - val_loss: 0.5638 - val_accuracy: 0.8212
Epoch 4/150
1407/1407 - 23s - loss: 0.3256 - accuracy: 0.8924 - val_loss: 0.5744 - val_accuracy: 0.8412
Epoch 5/150
1407/1407 - 23s - loss: 0.2544 - accuracy: 0.9169 - val_loss: 0.5707 - val_accuracy: 0.8368
Epoch 6/150
1407/1407 - 23s - loss: 0.2001 - accuracy: 0.9343 - val_loss: 0.6239 - val_accuracy: 0.8402
Epoch 7/150
1407/1407 - 23s - loss: 0.1454 - accuracy: 0.9528 - val_loss: 0.5300 - val_accuracy: 0.8622
Epoch 8/150
1407/1407 - 23s - loss: 0.1141 - accuracy: 0.9630 - val_loss: 0.7579 - val_accuracy: 0.8356
Epoch 9/150
1407/1407 - 23s - loss: 0.0974 - accuracy: 0.9689 - val_loss: 0.6277 - val_accuracy: 0.8668
Epoch 10/150
1407/1407 - 23s - loss: 0.0837 - accuracy: 0.9726 - val_loss: 0.6822 - val_accuracy: 0.8570
Epoch 11/150
1407/1407 - 23s - loss: 0.0695 - accuracy: 0.9777 - val_loss: 0.6938 - val_accuracy: 0.8676
Epoch 12/150
1407/1407 - 23s - loss: 0.0683 - accuracy: 0.9787 - val_loss: 0.7243 - val_accuracy: 0.8648
Epoch 13/150
1407/1407 - 23s - loss: 0.0621 - accuracy: 0.9800 - val_loss: 0.8035 - val_accuracy: 0.8524
Epoch 14/150
1407/1407 - 23s - loss: 0.0593 - accuracy: 0.9821 - val_loss: 0.7776 - val_accuracy: 0.8680
Epoch 15/150
1407/1407 - 23s - loss: 0.0500 - accuracy: 0.9842 - val_loss: 0.6551 - val_accuracy: 0.8736
Epoch 16/150
1407/1407 - 23s - loss: 0.0428 - accuracy: 0.9863 - val_loss: 0.7151 - val_accuracy: 0.8574
Epoch 17/150
1407/1407 - 23s - loss: 0.0424 - accuracy: 0.9869 - val_loss: 0.9365 - val_accuracy: 0.8562
Epoch 18/150
1407/1407 - 23s - loss: 0.0470 - accuracy: 0.9850 - val_loss: 0.7562 - val_accuracy: 0.8682
Epoch 19/150
1407/1407 - 23s - loss: 0.0392 - accuracy: 0.9880 - val_loss: 0.8104 - val_accuracy: 0.8726
Epoch 20/150
1407/1407 - 23s - loss: 0.0474 - accuracy: 0.9859 - val_loss: 0.7707 - val_accuracy: 0.8664
Epoch 21/150
1407/1407 - 23s - loss: 0.0312 - accuracy: 0.9903 - val_loss: 0.9241 - val_accuracy: 0.8686
Epoch 22/150
1407/1407 - 23s - loss: 0.0311 - accuracy: 0.9903 - val_loss: 0.8385 - val_accuracy: 0.8654
Epoch 23/150
1407/1407 - 23s - loss: 0.0333 - accuracy: 0.9892 - val_loss: 0.8404 - val_accuracy: 0.8678
Epoch 24/150
1407/1407 - 23s - loss: 0.0298 - accuracy: 0.9906 - val_loss: 0.8717 - val_accuracy: 0.8756
Epoch 25/150
1407/1407 - 23s - loss: 0.0259 - accuracy: 0.9916 - val_loss: 0.8962 - val_accuracy: 0.8664
Epoch 26/150
1407/1407 - 23s - loss: 0.0305 - accuracy: 0.9902 - val_loss: 0.9303 - val_accuracy: 0.8616
Epoch 27/150
1407/1407 - 23s - loss: 0.0257 - accuracy: 0.9921 - val_loss: 0.8379 - val_accuracy: 0.8714
Epoch 28/150
1407/1407 - 23s - loss: 0.0370 - accuracy: 0.9891 - val_loss: 0.7721 - val_accuracy: 0.8646
Epoch 29/150
1407/1407 - 23s - loss: 0.0184 - accuracy: 0.9944 - val_loss: 0.8967 - val_accuracy: 0.8664
Epoch 30/150
1407/1407 - 23s - loss: 0.0239 - accuracy: 0.9922 - val_loss: 1.0114 - val_accuracy: 0.8576
Epoch 31/150
1407/1407 - 23s - loss: 0.0249 - accuracy: 0.9921 - val_loss: 0.9091 - val_accuracy: 0.8668
Epoch 32/150
1407/1407 - 23s - loss: 0.0255 - accuracy: 0.9925 - val_loss: 0.8237 - val_accuracy: 0.8766
Epoch 33/150
1407/1407 - 23s - loss: 0.0198 - accuracy: 0.9940 - val_loss: 0.8210 - val_accuracy: 0.8728
Epoch 34/150
1407/1407 - 23s - loss: 0.0199 - accuracy: 0.9942 - val_loss: 0.8635 - val_accuracy: 0.8652
Epoch 35/150
1407/1407 - 23s - loss: 0.0212 - accuracy: 0.9934 - val_loss: 0.9468 - val_accuracy: 0.8604
Epoch 36/150
1407/1407 - 23s - loss: 0.0288 - accuracy: 0.9917 - val_loss: 0.7963 - val_accuracy: 0.8782
Epoch 37/150
1407/1407 - 23s - loss: 0.0178 - accuracy: 0.9946 - val_loss: 0.8370 - val_accuracy: 0.8730
Epoch 38/150
1407/1407 - 23s - loss: 0.0177 - accuracy: 0.9945 - val_loss: 0.9274 - val_accuracy: 0.8710
Epoch 39/150
1407/1407 - 23s - loss: 0.0194 - accuracy: 0.9942 - val_loss: 0.8940 - val_accuracy: 0.8662
Epoch 40/150
1407/1407 - 23s - loss: 0.0156 - accuracy: 0.9950 - val_loss: 0.8828 - val_accuracy: 0.8726
Epoch 41/150
1407/1407 - 23s - loss: 0.0309 - accuracy: 0.9919 - val_loss: 0.7987 - val_accuracy: 0.8824
Epoch 42/150
1407/1407 - 23s - loss: 0.0117 - accuracy: 0.9966 - val_loss: 0.9495 - val_accuracy: 0.8640
Epoch 43/150
1407/1407 - 23s - loss: 0.0167 - accuracy: 0.9949 - val_loss: 0.9066 - val_accuracy: 0.8666
Epoch 44/150
1407/1407 - 23s - loss: 0.0187 - accuracy: 0.9938 - val_loss: 0.9241 - val_accuracy: 0.8754
Epoch 45/150
1407/1407 - 23s - loss: 0.0165 - accuracy: 0.9950 - val_loss: 1.0446 - val_accuracy: 0.8600
Epoch 46/150
1407/1407 - 23s - loss: 0.0148 - accuracy: 0.9956 - val_loss: 0.9735 - val_accuracy: 0.8714
Epoch 47/150
1407/1407 - 23s - loss: 0.0145 - accuracy: 0.9957 - val_loss: 1.0283 - val_accuracy: 0.8688
Epoch 48/150
1407/1407 - 23s - loss: 0.0140 - accuracy: 0.9957 - val_loss: 0.9933 - val_accuracy: 0.8666
Epoch 49/150
1407/1407 - 23s - loss: 0.0168 - accuracy: 0.9950 - val_loss: 1.0298 - val_accuracy: 0.8710
Epoch 50/150
1407/1407 - 23s - loss: 0.0146 - accuracy: 0.9957 - val_loss: 0.9186 - val_accuracy: 0.8688
Epoch 51/150
1407/1407 - 23s - loss: 0.0112 - accuracy: 0.9966 - val_loss: 1.0689 - val_accuracy: 0.8676
Epoch 52/150
1407/1407 - 23s - loss: 0.0162 - accuracy: 0.9953 - val_loss: 1.0661 - val_accuracy: 0.8726
Epoch 53/150
1407/1407 - 23s - loss: 0.0125 - accuracy: 0.9961 - val_loss: 1.0688 - val_accuracy: 0.8698
Epoch 54/150
1407/1407 - 23s - loss: 0.0139 - accuracy: 0.9962 - val_loss: 1.1296 - val_accuracy: 0.8632
Epoch 55/150
1407/1407 - 22s - loss: 0.0154 - accuracy: 0.9954 - val_loss: 0.9091 - val_accuracy: 0.8748
Epoch 56/150
1407/1407 - 23s - loss: 0.0115 - accuracy: 0.9966 - val_loss: 1.0643 - val_accuracy: 0.8654
Epoch 57/150
1407/1407 - 23s - loss: 0.0152 - accuracy: 0.9958 - val_loss: 0.9658 - val_accuracy: 0.8678
Epoch 00057: early stopping
input_1 False
block1_conv1 False
batch_normalization False
block1_conv2 False
batch_normalization_1 False
block1_pool False
block2_conv1 False
batch_normalization_2 False
block2_conv2 False
batch_normalization_3 False
block2_pool False
block3_conv1 False
batch_normalization_4 False
block3_conv2 False
batch_normalization_5 False
block3_conv3 False
batch_normalization_6 False
block3_pool False
block4_conv1 False
batch_normalization_7 False
block4_conv2 False
batch_normalization_8 False
block4_conv3 False
batch_normalization_9 False
block4_pool False
block5_conv1 False
batch_normalization_10 False
block5_conv2 False
batch_normalization_11 False
block5_conv3 False
batch_normalization_12 False
block5_pool False
flatten False
fc1 False
batch_normalization_13 False
fc2 False
batch_normalization_14 False
predictions False
  0/250 [..............................] - ETA: 0sWARNING:tensorflow:The list of trainable weights is empty. Make sure that you are not setting model.trainable to False before compiling the model.
  1/250 [..............................] - ETA: 22:24 10/250 [>.............................] - ETA: 4:10  19/250 [=>............................] - ETA: 3:07 28/250 [==>...........................] - ETA: 2:42 37/250 [===>..........................] - ETA: 2:26 47/250 [====>.........................] - ETA: 2:13 57/250 [=====>........................] - ETA: 2:03 67/250 [=======>......................] - ETA: 1:54 76/250 [========>.....................] - ETA: 1:47 86/250 [=========>....................] - ETA: 1:40 96/250 [==========>...................] - ETA: 1:33106/250 [===========>..................] - ETA: 1:26116/250 [============>.................] - ETA: 1:19125/250 [==============>...............] - ETA: 1:14134/250 [===============>..............] - ETA: 1:08143/250 [================>.............] - ETA: 1:03152/250 [=================>............] - ETA: 57s 161/250 [==================>...........] - ETA: 52s171/250 [===================>..........] - ETA: 46s181/250 [====================>.........] - ETA: 40s191/250 [=====================>........] - ETA: 34s201/250 [=======================>......] - ETA: 28s211/250 [========================>.....] - ETA: 22s221/250 [=========================>....] - ETA: 16s230/250 [==========================>...] - ETA: 11s239/250 [===========================>..] - ETA: 6s 248/250 [============================>.] - ETA: 1sMCBN accuracy: 16.9%
MCBN-ensemble accuracy: 16.9%
Traceback (most recent call last):
  File "CIFAR10_MCBN.py", line 365, in <module>
    main()
  File "CIFAR10_MCBN.py", line 332, in main
    num_classes=NUM_CLASSES)
  File "/software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/ops/confusion_matrix.py", line 192, in confusion_matrix
    indices = array_ops.stack([labels, predictions], axis=1)
  File "/software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/util/dispatch.py", line 180, in wrapper
    return target(*args, **kwargs)
  File "/software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/ops/array_ops.py", line 1255, in stack
    return gen_array_ops.pack(values, axis=axis, name=name)
  File "/software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/ops/gen_array_ops.py", line 5693, in pack
    _ops.raise_from_not_ok_status(e, name)
  File "/software/software/TensorFlow/2.1.0-fosscuda-2019b-Python-3.7.4/lib/python3.7/site-packages/tensorflow_core/python/framework/ops.py", line 6606, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Shapes of all inputs must match: values[0].shape = [10000] != values[1].shape = [250,10000,10] [Op:Pack] name: stack


###############################################################################
Peregrine Cluster
Job 10095524 for user 's2934833'
Finished at: Sat Mar 14 11:58:48 CET 2020

Job details:
============

Name                : MCBNCIFAR10
User                : s2934833
Partition           : gpu
Nodes               : pg-gpu29
Cores               : 12
State               : FAILED
Submit              : 2020-03-14T11:13:41
Start               : 2020-03-14T11:34:21
End                 : 2020-03-14T11:58:48
Reserved walltime   : 02:00:00
Used walltime       : 00:24:27
Used CPU time       : 00:25:45 (efficiency:  8.78%)
% User (Computation): 81.18%
% System (I/O)      : 18.82%
Mem reserved        : 62.50G/node
Max Mem used        : 4.66G (pg-gpu29)
Max Disk Write      : 153.60K (pg-gpu29)
Max Disk Read       : 5.35M (pg-gpu29)


Acknowledgements:
=================

Please see this page for information about acknowledging Peregrine in your publications:

https://wiki.hpc.rug.nl/peregrine/additional_information/scientific_output

################################################################################
