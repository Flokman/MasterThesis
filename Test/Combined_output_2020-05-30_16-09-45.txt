
START MCDO
MNIST data returning
Total labels in train set:  [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000]
Labels in test set:  [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
/data/s2934833/MasterThesis/MCDO/CIFAR10/2020-05-20_11-01_imagenet_32B_68.6%A
MCDO combined accuracy: 85.4%
tf.Tensor(
[[902   6  21  10   8   3   7  10  23  10]
 [ 15 917   0   0   0   5   3   2  14  44]
 [ 25   1 819  19  45  39  42   8   1   1]
 [  6   4  38 565  46 257  46  21   6  11]
 [ 11   1  35  19 841  28  23  36   5   1]
 [  4   0  16  53  20 869  16  20   0   2]
 [  4   2  23  23  10  16 915   1   4   2]
 [  5   1  11  15  26  58   2 876   1   5]
 [ 39  10   5   3   4   2   1   1 927   8]
 [ 17  36   3   4   1   4   8   3  12 912]], shape=(10, 10), dtype=int32)
Correct: 8543, wrong: 1457, accuracy: 85.42999999999999%

Mean probability on true label of CIFAR10 test dataset when correctly predicted = 94.67%
Mean uncertainty on true label of CIFAR10 test dataset when correctly predicted = 2.38%
Mean probability on true label of CIFAR10 test dataset when wrongly predicted = 14.19%
Mean uncertainty on true label of CIFAR10 test dataset when wrongly predicted = 6.23%

Mean probability on highest predicted on CIFAR10 test dataset when wrong = 91.35%
Mean uncertainty on highest predicted on CIFAR10 test dataset when wrong = 3.37%

Mean probability on all not true label on CIFAR10 test dataset = 0.96%
Mean uncertainty on all not true label on CIFAR10 test dataset = 0.49%
creating scatterplot

Mean probability on highest predicted class of MNIST data = 75.66%
Mean uncertainty on highest predicted class of MNIST data = 8.63%
Mean probability on not predicted classes of MNIST data = 2.70%
Mean uncertainty on not predicted classes of MNIST data = 1.47%

START MCBN
MNIST data returning
Total labels in train set:  [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000]
Labels in test set:  [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
/data/s2934833/MasterThesis/MCBN/CIFAR10/2020-05-20_11-04_imagenet_32B_82.8%A
MCBN combined accuracy: 83.5%
tf.Tensor(
[[889  10  16   9   5   2   5  14  32  18]
 [ 13 920   0   5   0   0   1   1  11  49]
 [ 39   1 794  52  31  34  25  16   4   4]
 [ 10   4  39 711  21 144  29  26   5  11]
 [ 17   2  58  67 736  49  30  32   5   4]
 [  8   1  24 136  13 771   9  33   3   2]
 [  5   6  34  68  13  23 840   3   5   3]
 [  9   1  11  32   6  45   3 879   4  10]
 [ 39  19   5  13   2   0   0   2 897  23]
 [ 19  38   3   6   0   2   4   6  10 912]], shape=(10, 10), dtype=int32)
Correct: 8349, wrong: 1651, accuracy: 83.49%

Mean probability on true label of CIFAR10 test dataset when correctly predicted = 91.77%
Mean uncertainty on true label of CIFAR10 test dataset when correctly predicted = 6.89%
Mean probability on true label of CIFAR10 test dataset when wrongly predicted = 16.79%
Mean uncertainty on true label of CIFAR10 test dataset when wrongly predicted = 13.39%

Mean probability on highest predicted on CIFAR10 test dataset when wrong = 87.66%
Mean uncertainty on highest predicted on CIFAR10 test dataset when wrong = 8.91%

Mean probability on all not true label on CIFAR10 test dataset = 1.37%
Mean uncertainty on all not true label on CIFAR10 test dataset = 1.36%
creating scatterplot

Mean probability on highest predicted class of MNIST data = 77.46%
Mean uncertainty on highest predicted class of MNIST data = 2.32%
Mean probability on not predicted classes of MNIST data = 2.50%
Mean uncertainty on not predicted classes of MNIST data = 0.34%

START Ensemble
Dataset_name: CIFAR10, N_folders: 1, total mebers: 3
MNIST data returning
(10000, 75, 75, 3)
Total labels in train set:  [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000]
Labels in test set:  [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
loaded: ensemble_weights_Xception_0.h5
loaded: ensemble_weights_Xception_1.h5
loaded: ensemble_weights_Xception_2.h5
loaded: ensemble_weights_VGG16_0.h5
loaded: ensemble_weights_VGG16_1.h5
loaded: ensemble_weights_VGG16_2.h5
loaded: ensemble_weights_VGG19_0.h5
loaded: ensemble_weights_VGG19_1.h5
loaded: ensemble_weights_VGG19_2.h5
loaded: ensemble_weights_ResNet50_0.h5
loaded: ensemble_weights_ResNet50_1.h5
loaded: ensemble_weights_ResNet50_2.h5
loaded: ensemble_weights_ResNet101_0.h5
loaded: ensemble_weights_ResNet101_1.h5
loaded: ensemble_weights_ResNet101_2.h5
loaded: ensemble_weights_ResNet152_0.h5
loaded: ensemble_weights_ResNet152_1.h5
loaded: ensemble_weights_ResNet152_2.h5
loaded: ensemble_weights_ResNet50V2_0.h5
loaded: ensemble_weights_ResNet50V2_1.h5
loaded: ensemble_weights_ResNet50V2_2.h5
loaded: ensemble_weights_ResNet101V2_0.h5
loaded: ensemble_weights_ResNet101V2_1.h5
loaded: ensemble_weights_ResNet101V2_2.h5
loaded: ensemble_weights_ResNet152V2_0.h5
loaded: ensemble_weights_ResNet152V2_1.h5
loaded: ensemble_weights_ResNet152V2_2.h5
loaded: ensemble_weights_InceptionV3_0.h5
loaded: ensemble_weights_InceptionV3_1.h5
loaded: ensemble_weights_InceptionV3_2.h5
loaded: ensemble_weights_InceptionResNetV2_0.h5
loaded: ensemble_weights_InceptionResNetV2_1.h5
loaded: ensemble_weights_InceptionResNetV2_2.h5
loaded: ensemble_weights_DenseNet121_0.h5
loaded: ensemble_weights_DenseNet121_1.h5
loaded: ensemble_weights_DenseNet121_2.h5
loaded: ensemble_weights_DenseNet169_0.h5
loaded: ensemble_weights_DenseNet169_1.h5
loaded: ensemble_weights_DenseNet169_2.h5
loaded: ensemble_weights_DenseNet201_0.h5
loaded: ensemble_weights_DenseNet201_1.h5
loaded: ensemble_weights_DenseNet201_2.h5
Ensemble combined accuracy: 79.4%
tf.Tensor(
[[832  13  19  13   6   2   7  11  65  32]
 [ 12 888   1   1   0   4   8   3  16  67]
 [ 59   2 679  41  85  38  55  22  10   9]
 [ 16   7  57 644  39 125  52  33  13  14]
 [ 23   2  42  43 759  20  41  59   9   2]
 [ 10   4  34 152  41 700  12  38   1   8]
 [  6   5  25  43  26  18 868   2   4   3]
 [ 14   4  16  33  45  39   5 827   2  15]
 [ 42  28  10  10   4   1   1   3 882  19]
 [ 18  58   8   9   2   7   4   7  30 857]], shape=(10, 10), dtype=int32)
Correct: 7936, wrong: 2064, accuracy: 79.36%

Mean probability on true label of CIFAR10 test dataset when correctly predicted = 68.11%
Mean uncertainty on true label of CIFAR10 test dataset when correctly predicted = 25.07%
Mean probability on true label of CIFAR10 test dataset when wrongly predicted = 20.33%
Mean uncertainty on true label of CIFAR10 test dataset when wrongly predicted = 20.27%

Mean probability on highest predicted on CIFAR10 test dataset when wrong = 63.21%
Mean uncertainty on highest predicted on CIFAR10 test dataset when wrong = 25.64%

Mean probability on all not true label on CIFAR10 test dataset = 4.09%
Mean uncertainty on all not true label on CIFAR10 test dataset = 5.67%
creating scatterplot
loaded: ensemble_weights_Xception_0.h5
loaded: ensemble_weights_Xception_1.h5
loaded: ensemble_weights_Xception_2.h5
loaded: ensemble_weights_VGG16_0.h5
loaded: ensemble_weights_VGG16_1.h5
loaded: ensemble_weights_VGG16_2.h5
loaded: ensemble_weights_VGG19_0.h5
loaded: ensemble_weights_VGG19_1.h5
loaded: ensemble_weights_VGG19_2.h5
loaded: ensemble_weights_ResNet50_0.h5
loaded: ensemble_weights_ResNet50_1.h5
loaded: ensemble_weights_ResNet50_2.h5
loaded: ensemble_weights_ResNet101_0.h5
loaded: ensemble_weights_ResNet101_1.h5
loaded: ensemble_weights_ResNet101_2.h5
loaded: ensemble_weights_ResNet152_0.h5
loaded: ensemble_weights_ResNet152_1.h5
loaded: ensemble_weights_ResNet152_2.h5
loaded: ensemble_weights_ResNet50V2_0.h5
loaded: ensemble_weights_ResNet50V2_1.h5
loaded: ensemble_weights_ResNet50V2_2.h5
loaded: ensemble_weights_ResNet101V2_0.h5
loaded: ensemble_weights_ResNet101V2_1.h5
loaded: ensemble_weights_ResNet101V2_2.h5
loaded: ensemble_weights_ResNet152V2_0.h5
loaded: ensemble_weights_ResNet152V2_1.h5
loaded: ensemble_weights_ResNet152V2_2.h5
loaded: ensemble_weights_InceptionV3_0.h5
loaded: ensemble_weights_InceptionV3_1.h5
loaded: ensemble_weights_InceptionV3_2.h5
loaded: ensemble_weights_InceptionResNetV2_0.h5
loaded: ensemble_weights_InceptionResNetV2_1.h5
loaded: ensemble_weights_InceptionResNetV2_2.h5
loaded: ensemble_weights_DenseNet121_0.h5
loaded: ensemble_weights_DenseNet121_1.h5
loaded: ensemble_weights_DenseNet121_2.h5
loaded: ensemble_weights_DenseNet169_0.h5
loaded: ensemble_weights_DenseNet169_1.h5
loaded: ensemble_weights_DenseNet169_2.h5
loaded: ensemble_weights_DenseNet201_0.h5
loaded: ensemble_weights_DenseNet201_1.h5
loaded: ensemble_weights_DenseNet201_2.h5

Mean probability on highest predicted class of MNIST data = 35.60%
Mean uncertainty on highest predicted class of MNIST data = 27.74%
Mean probability on not predicted classes of MNIST data = 7.16%
Mean uncertainty on not predicted classes of MNIST data = 11.28%

START VarianceOutput
MNIST data returning
Total labels in train set:  [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000]
Labels in test set:  [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
/data/s2934833/MasterThesis/VarianceOutput/CIFAR10/2020-05-20_11-16_imagenet_128B_69.4%A
Accuracy on original test dataset: 83.8%
tf.Tensor(
[[883   7  13  26   8   1   2   8  37  15]
 [ 11 905   1  10   0   4   4   1  12  52]
 [ 42   2 758  73  45  33  30  14   2   1]
 [  8   4  22 745  38 129  25  19   4   6]
 [ 11   1  25  80 807  23  18  26   8   1]
 [  1   1  11 170  19 761  11  23   1   2]
 [  3   3  16  65  17  16 874   2   4   0]
 [  9   3   8  46  39  55   3 831   0   6]
 [ 43  10   5   7   4   1   1   2 917  10]
 [ 15  50   2  12   0   3   4   2  14 898]], shape=(10, 10), dtype=int32)
Correct: 8379, wrong: 1621, accuracy: 83.78999999999999%

Mean probability on true label of original test dataset when correctly predicted = 98.54%
Mean uncertainty on true label of original test dataset when correctly predicted = 10.22%
Mean probability on true label of original test dataset when wrongly predicted = 6.36%
Mean uncertainty on true label of original test dataset when wrongly predicted = 10.56%

Mean probability on highest predicted on original test dataset when wrong = 89.08%
Mean uncertainty on highest predicted on original test dataset when wrong = 10.74%

Mean probability on all not true label on original test dataset = 1.82%
Mean uncertainty on all not true label on original test dataset = 9.97%
creating scatterplot
With error converted to uncertainty
Accuracy on original test dataset: 83.8%
tf.Tensor(
[[883   7  13  26   8   1   2   8  37  15]
 [ 11 905   1  10   0   4   4   1  12  52]
 [ 42   2 758  73  45  33  30  14   2   1]
 [  8   4  22 745  38 129  25  19   4   6]
 [ 11   1  25  80 807  23  18  26   8   1]
 [  1   1  11 170  19 761  11  23   1   2]
 [  3   3  16  65  17  16 874   2   4   0]
 [  9   3   8  46  39  55   3 831   0   6]
 [ 43  10   5   7   4   1   1   2 917  10]
 [ 15  50   2  12   0   3   4   2  14 898]], shape=(10, 10), dtype=int32)
Correct: 8379, wrong: 1621, accuracy: 83.78999999999999%

Mean probability on true label of original test dataset when correctly predicted = 98.54%
Mean uncertainty on true label of original test dataset when correctly predicted = 10.04%
Mean probability on true label of original test dataset when wrongly predicted = 6.36%
Mean uncertainty on true label of original test dataset when wrongly predicted = 9.57%

Mean probability on highest predicted on original test dataset when wrong = 89.08%
Mean uncertainty on highest predicted on original test dataset when wrong = 9.74%

Mean probability on all not true label on original test dataset = 1.82%
Mean uncertainty on all not true label on original test dataset = 9.92%
creating scatterplot

Mean probability on highest predicted class of new data = 88.48%
Mean uncertainty on highest predicted class of new data = 10.35%
Mean probability on not highest predicted class of new data = 1.28%
Mean uncertainty on not predicted classes of new data = 9.96%
creating scatterplot
With error converted to uncertainty

Mean probability on highest predicted class of new data = 88.48%
Mean uncertainty on highest predicted class of new data = 9.77%
Mean probability on not highest predicted class of new data = 1.28%
Mean uncertainty on not predicted classes of new data = 9.77%
creating scatterplot

#################################
Function main called 1 times. 
Execution time max: 1895.944, average: 1895.944
#################################
